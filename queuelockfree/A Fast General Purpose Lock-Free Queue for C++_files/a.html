<!DOCTYPE html>
<!--[if IE 8]><html lang="en" dir="ltr" class="ie8"><![endif]-->
<!--[if IE 9]><html lang="en" dir="ltr" class="ie9"><![endif]-->
<!--[if gt IE 9]><!-->
<html dir="ltr" class="js no-touch localstorage sessionstorage contenteditable use-opacity-transitions" lang="en"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Disqus Comments</title>

    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
        .alert--warning {
            border-radius: 3px;
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #FFE070;
            color: #A47703;
        }

        .alert--warning a,
        .alert--warning a:hover,
        .alert--warning strong {
            color: #A47703;
            font-weight: bold;
        }

        .alert--error p,
        .alert--warning p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        </style>
    
    <style>
        
        html {
            overflow: hidden;
        }
        

        #error {
            display: none;
        }

        .clearfix:after {
            content: "";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        
    </style>

<script src="a_data/cbgapi.loaded_0" async=""></script><script crossorigin="anonymous" id="bootstrap-script" data-app="lounge" src="a_data/lounge_002.js"></script><meta http-equiv="Content-Security-Policy" content="script-src https:;"><link rel="stylesheet" href="a_data/lounge.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lounge/main" src="a_data/lounge.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="remote/config" src="a_data/config.js"></script><style id="css_1527631799664"></style><!-- base href="https://disqus.com/embed/comments/?base=default&f=moodycamel&t_u=http%3A%2F%2Fmoodycamel.com%2Fblog%2F2014%2Fa-fast-general-purpose-lock-free-queue-for-c%2B%2B&t_d=%0A%0AA%20Fast%20General%20Purpose%20Lock-Free%20Queue%20for%20C%2B%2B%0A%0A&t_t=%0A%0AA%20Fast%20General%20Purpose%20Lock-Free%20Queue%20for%20C%2B%2B%0A%0A&s_o=default" --><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="fb" src="a_data/sdk.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="gapi" src="a_data/api.js" gapi_processed="true"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in{animation-duration:250ms;animation-name:fb_bounce_in}.fb_customer_chat_bounce_out{animation-duration:250ms;animation-name:fb_fade_out}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{background-color:#fff;height:100%;overflow:hidden;position:fixed;visibility:hidden;width:100%}@keyframes fb_fade_out{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_in{0%{opacity:0;transform:scale(.8, .8);transform-origin:100% 100%}10%{opacity:.1}20%{opacity:.2}30%{opacity:.3}40%{opacity:.4}50%{opacity:.5}60%{opacity:.6}70%{opacity:.7}80%{opacity:.8;transform:scale(1.03, 1.03)}90{opacity:.9}100%{opacity:1;transform:scale(1, 1)}}</style></head>
<body>
    

    
    <div id="error" class="alert--error">
        <p>We were unable to load Disqus. If you are a moderator please see our <a href="https://docs.disqus.com/help/83/"> troubleshooting guide</a>. </p>
    </div>

    
    <script type="text/json" id="disqus-forumData">{"session":{"canModerate":false,"audienceSyncVerified":false,"mustVerify":false,"canReply":true,"mustVerifyEmail":false},"forum":{"aetBannerConfirmation":null,"founder":"18992720","twitterName":"","commentsLinkOne":"1 comment","guidelines":null,"favicon":{"permalink":"https://disqus.com/api/forums/favicons/moodycamel.jpg","cache":"https://c.disquscdn.com/uploads/forums/112/4748/favicon.png"},"commentsLinkZero":"No comments","disableDisqusBranding":false,"daysAlive":0,"createdAt":"2011-11-12T00:42:30.420311","category":null,"aetBannerEnabled":false,"aetBannerTitle":null,"raw_guidelines":null,"colorScheme":"light","id":"moodycamel","installCompleted":true,"moderatorBadgeText":null,"commentPolicyText":null,"aetEnabled":false,"channel":null,"sort":2,"description":"","newPolicy":true,"raw_description":"","language":"en","adsReviewStatus":0,"pk":"1124748","forumCategory":null,"permissions":{},"commentPolicyLink":null,"aetBannerDescription":null,"name":"moodycamel.com","commentsLinkMultiple":"{num} comments","settings":{"adsDRNativeEnabled":false,"disable3rdPartyTrackers":false,"adsVideoEnabled":false,"adsProductVideoEnabled":false,"adsPositionTopEnabled":false,"ssoRequired":false,"unapproveLinks":false,"adsEnabled":false,"adsProductLinksThumbnailsEnabled":false,"hasCustomAvatar":false,"organicDiscoveryEnabled":false,"allowMedia":false,"adsProductDisplayEnabled":false,"adsProductLinksEnabled":false,"linkAffiliationEnabled":false,"allowAnonPost":true,"adsProductStoriesEnabled":false,"adultContent":false,"allowAnonVotes":false,"mustVerify":true,"mustVerifyEmail":true,"audienceSyncEnabled":false,"mediaembedEnabled":false,"adsPositionBottomEnabled":false,"discoveryLocked":false,"validateAllPosts":false,"adsSettingsLocked":false,"isVIP":false,"adsPositionInthreadEnabled":false},"organizationId":847484,"typeface":"sans-serif","url":"http://moodycamel.com","daysThreadAlive":0,"avatar":{"small":{"permalink":"https://disqus.com/api/forums/avatars/moodycamel.jpg?size=32","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"large":{"permalink":"https://disqus.com/api/forums/avatars/moodycamel.jpg?size=92","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}},"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ"}}</script>

    <script type="text/json" id="disqus-threadData">{"cursor":{"hasPrev":false,"prev":null,"total":79,"hasNext":true,"next":"1:0:0"},"code":0,"response":{"lastModified":1524743705,"posts":[{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Have you compared performance with the fastflow MPMC queue? They use SPSC queues per producer and per consumer, and use an arbiter thread to multuplex them. The SPSC queues are extremely fast since they don't use atomic operations and a thread reads/writes either only the head or only the tail, avoiding sharing, and also avoiding any CPU fences on x86.\u003c/p>","id":"3413790219","isHighlighted":false,"author":{"username":"dispayname","about":"","name":"Dispay Name","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-06-12T18:27:49","profileUrl":"https://disqus.com/by/dispayname/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"161387292","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/dispayname.jpg","cache":"https://c.disquscdn.com/uploads/users/16138/7292/avatar32.jpg?1434425682"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/dispayname.jpg","cache":"https://c.disquscdn.com/uploads/users/16138/7292/avatar92.jpg?1434425682","large":{"permalink":"https://disqus.com/api/users/avatars/dispayname.jpg","cache":"https://c.disquscdn.com/uploads/users/16138/7292/avatar92.jpg?1434425682"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-07-12T22:28:49","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Have you compared performance with the fastflow MPMC queue? They use SPSC queues per producer and per consumer, and use an arbiter thread to multuplex them. The SPSC queues are extremely fast since they don't use atomic operations and a thread reads/writes either only the head or only the tail, avoiding sharing, and also avoiding any CPU fences on x86.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>No, I haven't. But yes, using SPSC queues between pairs of cores is ideal where possible.\u003c/p>","id":"3414619889","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-07-13T13:23:33","parent":3413790219,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"No, I haven't. But yes, using SPSC queues between pairs of cores is ideal where possible.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hello Cameron, is there a way in which we can dequeue the latest item from the ConcurrentQueue (i.e the last item that was entered). I think the dequeue function always returns the first item entered in the queue... Thanks,\u003c/p>","id":"3184195473","isHighlighted":false,"author":{"username":"JC_15","about":"","name":"JC","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-05-23T21:08:36","profileUrl":"https://disqus.com/by/JC_15/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"158816189","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/JC_15.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/JC_15.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/JC_15.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-03T10:21:58","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hello Cameron, is there a way in which we can dequeue the latest item from the ConcurrentQueue (i.e the last item that was entered). I think the dequeue function always returns the first item entered in the queue... Thanks,","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Sorry, this isn't possible. The queue implementation is highly special purpose, and can't be adapted with e.g. stack functionality. \u003c/p>","id":"3184328425","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-03T12:50:38","parent":3184195473,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Sorry, this isn't possible. The queue implementation is highly special purpose, and can't be adapted with e.g. stack functionality. ","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks...I guess the only solution will be to store the item getting enqued into a local variable. But then will have to synchronize access to the variable...crude solution but will work i guess....\u003c/p>","id":"3184387251","isHighlighted":false,"author":{"username":"JC_15","about":"","name":"JC","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-05-23T21:08:36","profileUrl":"https://disqus.com/by/JC_15/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"158816189","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/JC_15.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/JC_15.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/JC_15.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-03T13:32:11","parent":3184328425,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks...I guess the only solution will be to store the item getting enqued into a local variable. But then will have to synchronize access to the variable...crude solution but will work i guess....","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Can you do a benchmark for android devices please ? using android ndk\u003c/p>","id":"3098181144","isHighlighted":false,"author":{"username":"disqus_7XqKPXBZnm","about":"","name":"wdswd","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-07-18T16:57:53","profileUrl":"https://disqus.com/by/disqus_7XqKPXBZnm/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"114903755","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_7XqKPXBZnm.jpg","cache":"https://c.disquscdn.com/uploads/users/11490/3755/avatar32.jpg?1405702684"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_7XqKPXBZnm.jpg","cache":"https://c.disquscdn.com/uploads/users/11490/3755/avatar92.jpg?1405702684","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_7XqKPXBZnm.jpg","cache":"https://c.disquscdn.com/uploads/users/11490/3755/avatar92.jpg?1405702684"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-13T22:36:49","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Can you do a benchmark for android devices please ? using android ndk","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>No, sorry. No time and no Android development environment set up.\u003c/p>","id":"3098184512","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-01-13T22:39:22","parent":3098181144,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"No, sorry. No time and no Android development environment set up.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>You are a God among mortals sir! This is really convenient!\u003c/p>","id":"2980496649","isHighlighted":false,"author":{"username":"disqus_w9sOOsNeSb","about":"","name":"john","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2012-09-18T08:52:32","profileUrl":"https://disqus.com/by/disqus_w9sOOsNeSb/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"32390672","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_w9sOOsNeSb.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_w9sOOsNeSb.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_w9sOOsNeSb.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-11-02T04:22:44","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"You are a God among mortals sir! This is really convenient!","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thank you for posting this. Awesome data structure and ideas. May I point you to test your concurrent queue against this data structure described in the link below? -&gt; \u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fwww.linuxjournal.com%2Fcontent%2Flock-free-multi-producer-multi-consumer-queue-ring-buffer%3ASH5To1bxdw5Mg8RKBT0UZhKDnB8&amp;cuid=1124748\" rel=\"nofollow noopener\" title=\"http://www.linuxjournal.com/content/lock-free-multi-producer-multi-consumer-queue-ring-buffer\">http://www.linuxjournal.com...\u003c/a> I think it will be an interesting fight, tough I think your queue would be much faster. Also, how exactly did you made the benchmarks? Is benchmark code included in github? Cheers!\u003c/p>","id":"2754527325","isHighlighted":false,"author":{"username":"marcopagliaricci","about":"","name":"Marco Pagliaricci","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-06-28T09:14:56","profileUrl":"https://disqus.com/by/marcopagliaricci/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"213144148","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/marcopagliaricci.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/marcopagliaricci.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/marcopagliaricci.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-06-28T09:22:19","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thank you for posting this. Awesome data structure and ideas. May I point you to test your concurrent queue against this data structure described in the link below? -> http://www.linuxjournal.com/content/lock-free-multi-producer-multi-consumer-queue-ring-buffer I think it will be an interesting fight, tough I think your queue would be much faster. Also, how exactly did you made the benchmarks? Is benchmark code included in github? Cheers!","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>Interesting! No, I don't think I'll add it to the benchmarks. It's not very portable code as is (it assumes a GCC compliant compiler). Its design constraints are also significantly different from those I chose (ring-buffer vs dynamically expanding, number of producers/consumers known in advance vs adaptable, etc.), which would make the comparison a little unfair for both queues.\u003c/p>\u003cp>The benchmark code \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fcameron314%2Fconcurrentqueue%2Ftree%2Fmaster%2Fbenchmarks%3AN20hTIrIvSl9N4Rqmc617JWVACo&amp;cuid=1124748\" rel=\"nofollow noopener\" title=\"https://github.com/cameron314/concurrentqueue/tree/master/benchmarks\">is indeed on GitHub\u003c/a>, so feel free to experiment with it yourself (it's not too hard to add another queue, it basically just requires filling out some tables at the top and writing the glue code to give it a consistent interface).\u003c/p>","id":"2754733538","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-06-28T12:42:55","parent":2754527325,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Interesting! No, I don't think I'll add it to the benchmarks. It's not very portable code as is (it assumes a GCC compliant compiler). Its design constraints are also significantly different from those I chose (ring-buffer vs dynamically expanding, number of producers/consumers known in advance vs adaptable, etc.), which would make the comparison a little unfair for both queues.\n\nThe benchmark code \u003ca href=\"https://github.com/cameron314/concurrentqueue/tree/master/benchmarks\">is indeed on GitHub\u003c/a>, so feel free to experiment with it yourself (it's not too hard to add another queue, it basically just requires filling out some tables at the top and writing the glue code to give it a consistent interface).","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":1,"moderationLabels":["links"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks for your reply. I agree that those 2 queues are indeed very different. I have a request: in a previous post, explaining the internal functioning of your MPMC concurrent queue, you said that it is basically composed of N SPMC queues. I think would be useful for users to have those SPMC queues to be used as a separate tool. Also, I find very useful MPSC queues, because it is very common to have one thread which loops and consumes tasks coming from N other threads. What are your thoughts on having those optimized SPMC and MPSC queues? Do you plan to spend some time on that?\u003c/p>","id":"2755750316","isHighlighted":false,"author":{"username":"marcopagliaricci","about":"","name":"Marco Pagliaricci","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-06-28T09:14:56","profileUrl":"https://disqus.com/by/marcopagliaricci/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"213144148","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/marcopagliaricci.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/marcopagliaricci.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/marcopagliaricci.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-06-28T22:48:10","parent":2754733538,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks for your reply. I agree that those 2 queues are indeed very different. I have a request: in a previous post, explaining the internal functioning of your MPMC concurrent queue, you said that it is basically composed of N SPMC queues. I think would be useful for users to have those SPMC queues to be used as a separate tool. Also, I find very useful MPSC queues, because it is very common to have one thread which loops and consumes tasks coming from N other threads. What are your thoughts on having those optimized SPMC and MPSC queues? Do you plan to spend some time on that?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>My MPMC queue can be used as a SPMC queue with almost no overhead. I do think it's a good idea to have separate optimized implementations for SPMC and MPSC, as well as a MPMC ring-buffer -- but I don't have much time ;-) Someday, maybe, when I'm in the mood!\u003c/p>","id":"2755848978","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-06-29T00:06:04","parent":2755750316,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"My MPMC queue can be used as a SPMC queue with almost no overhead. I do think it's a good idea to have separate optimized implementations for SPMC and MPSC, as well as a MPMC ring-buffer -- but I don't have much time ;-) Someday, maybe, when I'm in the mood!","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":3,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>i agree with Jacob's opinion that prefer to simple spsc lock-free queue. I saw many people are using very simple spsp queue that comes from Linux Kernel. Any queue that is implemented based on CAS still has race-condition happening at hardware level. But linux queue is a 100% \"lock-free\" queue where two threads \u003cbr>can run 100% independently.\u003cbr>In addition, what I want to say is that you can use more than one spsc queue to replace mpmq queue.\u003c/p>","id":"2581027216","isHighlighted":false,"author":{"username":"kiddinglife","about":"","name":"Jake Zhang","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-03-21T10:35:50","profileUrl":"https://disqus.com/by/kiddinglife/","url":"https://kiddinglife.github.io","location":"","isPrivate":false,"signedUrl":"https://disq.us/?url=https%3A%2F%2Fkiddinglife.github.io&key=9W1JkQCdjs605qOoG5-h2Q","isPrimary":true,"isAnonymous":false,"id":"201188582","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/kiddinglife.jpg","cache":"https://c.disquscdn.com/uploads/users/20118/8582/avatar32.jpg?1491457669"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/kiddinglife.jpg","cache":"https://c.disquscdn.com/uploads/users/20118/8582/avatar92.jpg?1491457669","large":{"permalink":"https://disqus.com/api/users/avatars/kiddinglife.jpg","cache":"https://c.disquscdn.com/uploads/users/20118/8582/avatar92.jpg?1491457669"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-03-21T10:38:07","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"i agree with Jacob's opinion that prefer to simple spsc lock-free queue. I saw many people are using very simple spsp queue that comes from Linux Kernel. Any queue that is implemented based on CAS still has race-condition happening at hardware level. But linux queue is a 100% \"lock-free\" queue where two threads \ncan run 100% independently.\nIn addition, what I want to say is that you can use more than one spsc queue to replace mpmq queue.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>There's always a race at the hardware level. It's a shared data structure, thus at some point memory has to be shared between the two threads. Sharing memory leads to races in the cache hardware, even if it's only reading memory that the other thread is only writing.\u003c/p>\u003cp>\"Lock-free\" means just that, a CAS doesn't lock anything in any meaningful sense because it cannot be interrupted at the hardware level -- it is truly atomic (though possibly slower under contention). My queue, by the way, doesn't use CAS on the fast path, but rather FAA.\u003c/p>\u003cp>Anyway, a SPSC queue is obviously simpler than a MPMC queue. If all you need is SPSC, or series of SPSCs, then of course, use one that's specifically SPSC instead (like the \u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fmoodycamel.com%2Fblog%2F2013%2Fa-fast-lock-free-queue-for-c%2B%2B%3AqiyUCbCeZ4TI_m1EfBqf5V6MclU&amp;cuid=1124748\" rel=\"nofollow noopener\" title=\"http://moodycamel.com/blog/2013/a-fast-lock-free-queue-for-c++\">one I wrote\u003c/a>).\u003c/p>","id":"2635945357","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-21T19:40:22","parent":2581027216,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"There's always a race at the hardware level. It's a shared data structure, thus at some point memory has to be shared between the two threads. Sharing memory leads to races in the cache hardware, even if it's only reading memory that the other thread is only writing.\n\n\"Lock-free\" means just that, a CAS doesn't lock anything in any meaningful sense because it cannot be interrupted at the hardware level -- it is truly atomic (though possibly slower under contention). My queue, by the way, doesn't use CAS on the fast path, but rather FAA.\n\nAnyway, a SPSC queue is obviously simpler than a MPMC queue. If all you need is SPSC, or series of SPSCs, then of course, use one that's specifically SPSC instead (like the \u003ca href=\"http://moodycamel.com/blog/2013/a-fast-lock-free-queue-for-c++\">one I wrote\u003c/a>).","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":["links"],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Unfortunately, if you look deeper into the CAS x86 machine code, you'll find\u003c/p>\u003cp>lock cmpxchg\u003c/p>\u003cp>and if you even look deeper into an \"atomic increment\", you'll find\u003c/p>\u003cp>lock inc\u003c/p>\u003cp>or\u003c/p>\u003cp>lock xadd\u003c/p>\u003cp>So, it's quite ironic calling the final implementation \"lock free\". Yes, these are the hardware-level locks, they cannot be interrupted, but the name stands for itself :) Also they introduce additional delays due to cache line locking for the time of operation. Moreover, Windows SRW locks use just one lock cmpxchg instruction per operation.\u003c/p>","id":"3164071748","isHighlighted":false,"author":{"username":"dmitriykanareykin","about":"","name":"Dmitriy Kanareykin","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-02-19T18:08:46","profileUrl":"https://disqus.com/by/dmitriykanareykin/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"242852897","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/dmitriykanareykin.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/dmitriykanareykin.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/dmitriykanareykin.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-02-19T18:22:00","parent":2635945357,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Unfortunately, if you look deeper into the CAS x86 machine code, you'll find\n\nlock cmpxchg\n\nand if you even look deeper into an \"atomic increment\", you'll find\n\nlock inc\n\nor\n\nlock xadd\n\nSo, it's quite ironic calling the final implementation \"lock free\". Yes, these are the hardware-level locks, they cannot be interrupted, but the name stands for itself :) Also they introduce additional delays due to cache line locking for the time of operation. Moreover, Windows SRW locks use just one lock cmpxchg instruction per operation.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>If you look deeper into lock free algorithms you'll find that none but the simplest data structures can be implemented with just atomic loads/stores (which still cause cache contention). CAS and FAA are atomic operations (and therefore yes, in some sense, locking), but the algorithm built on top of them is not.\u003cbr>The definition of lock-free is simply that the system is guaranteed to progress if at least one thread (any thread) is allowed to progress. My queue offers this guarantee on the fast path.\u003c/p>\u003cp>If you benchmark an SRW lock based queue, I think you'll find it slower past a handful of concurrent threads.\u003c/p>","id":"3165352306","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-02-20T13:53:30","parent":3164071748,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"If you look deeper into lock free algorithms you'll find that none but the simplest data structures can be implemented with just atomic loads/stores (which still cause cache contention). CAS and FAA are atomic operations (and therefore yes, in some sense, locking), but the algorithm built on top of them is not.\nThe definition of lock-free is simply that the system is guaranteed to progress if at least one thread (any thread) is allowed to progress. My queue offers this guarantee on the fast path.\n\nIf you benchmark an SRW lock based queue, I think you'll find it slower past a handful of concurrent threads.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":3,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Can you please point me to the linux kernel spsc queue you referred above and can you quote some examples of robust spsc lock-free queues.\u003c/p>","id":"2635787751","isHighlighted":false,"author":{"username":"disqus_EsG3GvGgSC","about":"","name":"Vincent","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-04-21T18:12:01","profileUrl":"https://disqus.com/by/disqus_EsG3GvGgSC/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"205314822","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_EsG3GvGgSC.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_EsG3GvGgSC.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_EsG3GvGgSC.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-21T18:17:46","parent":2581027216,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Can you please point me to the linux kernel spsc queue you referred above and can you quote some examples of robust spsc lock-free queues.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I had a quick look at the code...... I gave up very quickly.... \u003cbr>You can delete my comment after reading together with your blog entry and code on git.\u003cbr>This code is a humongous piece of spaghetti.. how exactly do you  attach the words \"commercial strength\" to it, huh?!?\u003c/p>\u003cp>Also, after about a minute I noticed you 'CanAlloc'. So that's not exactly lock-free is it?\u003cbr>Do you really believe anybody _serious_, in any company, would use anything like that? you must be joking.\u003cbr>I happen to have quite a bit of lock-free experience and let me tell you something - lock free things are typically very small in terms of lines of code and everything else. Not many abstraction levels to be easy to follow. Heavy C accent, no C++11, so it's easy to see how does it translate to asm.\u003cbr>Also, nobody needs a queue that allocates memory left and right. No malloc is not lock free (unless you provide your own lock free allocator and that's gonna be size limited....) so what have you gained there? People use either circular buffers or go intrusive (entries contain 'T* next'). Sync and wait are left out of the picture as in my world you typically spin rather than sleep. Lock free things, in general, are never full fledged whatever. They always give up on many things to achieve the one thing they need with ultimate speed, so don't try to go this way.\u003c/p>","id":"2449330343","isHighlighted":false,"author":{"name":"Jacob","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar32.png","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-01-10T03:15:33","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I had a quick look at the code...... I gave up very quickly.... \nYou can delete my comment after reading together with your blog entry and code on git.\nThis code is a humongous piece of spaghetti.. how exactly do you  attach the words \"commercial strength\" to it, huh?!?\n\nAlso, after about a minute I noticed you 'CanAlloc'. So that's not exactly lock-free is it?\nDo you really believe anybody _serious_, in any company, would use anything like that? you must be joking.\nI happen to have quite a bit of lock-free experience and let me tell you something - lock free things are typically very small in terms of lines of code and everything else. Not many abstraction levels to be easy to follow. Heavy C accent, no C++11, so it's easy to see how does it translate to asm.\nAlso, nobody needs a queue that allocates memory left and right. No malloc is not lock free (unless you provide your own lock free allocator and that's gonna be size limited....) so what have you gained there? People use either circular buffers or go intrusive (entries contain 'T* next'). Sync and wait are left out of the picture as in my world you typically spin rather than sleep. Lock free things, in general, are never full fledged whatever. They always give up on many things to achieve the one thing they need with ultimate speed, so don't try to go this way.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":2,"message":"\u003cp>I believe my exact words were \"industrial strength\", due to the features supported, combined with its speed. Yes, the code is messy and complex, mainly due to the quantity of optional features. Does that mean it's wrong? Worthless? Of course not. (Ironically, you managed to miss most of the actual flaws of the queue, which are already fairly well outlined in the documentation.)\u003c/p>\u003cp>It may not be what you're looking for, which is fine. You don't have to use it if you don't like it, or don't need any of its features. Go right ahead and write your own small highly-specialized lock-free data structure for each situation as it turns up. Don't forget to write the unit tests, scheduling-simulation tests, and ideally comparative benchmarks too. But not everyone has the luxury to spend that much time on a one-off data structure. That's why general-purpose, \"kitchen sink\" queues like mine and Boost's, and Intel's entire TBB library exist -- they allow the programmer to focus on their actual application at a higher level of abstraction. In fact, that's why most libraries exist.\u003c/p>\u003cp>If you'd spent less time scoffing at the code and more reading the documentation, you'd realize that external memory allocation (malloc) can only occur if the programmer chooses to use the version of the API that allows dynamic growth of the queue. This is a feature provided for convenience that, as it turns out, many people do actually use. Ditto for the (optional) exception safety and blocking version of the queue (both added solely due to public demand). It's completely lock-free if you need it to be, and still lock-free in the common case otherwise.\u003c/p>\u003cp>P.S. You come across as arrogant and a little bitter. You might want to work on that.\u003c/p>","id":"2449520906","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-01-10T06:30:12","parent":2449330343,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I believe my exact words were \"industrial strength\", due to the features supported, combined with its speed. Yes, the code is messy and complex, mainly due to the quantity of optional features. Does that mean it's wrong? Worthless? Of course not. (Ironically, you managed to miss most of the actual flaws of the queue, which are already fairly well outlined in the documentation.)\n\n\nIt may not be what you're looking for, which is fine. You don't have to use it if you don't like it, or don't need any of its features. Go right ahead and write your own small highly-specialized lock-free data structure for each situation as it turns up. Don't forget to write the unit tests, scheduling-simulation tests, and ideally comparative benchmarks too. But not everyone has the luxury to spend that much time on a one-off data structure. That's why general-purpose, \"kitchen sink\" queues like mine and Boost's, and Intel's entire TBB library exist -- they allow the programmer to focus on their actual application at a higher level of abstraction. In fact, that's why most libraries exist.\n\n\nIf you'd spent less time scoffing at the code and more reading the documentation, you'd realize that external memory allocation (malloc) can only occur if the programmer chooses to use the version of the API that allows dynamic growth of the queue. This is a feature provided for convenience that, as it turns out, many people do actually use. Ditto for the (optional) exception safety and blocking version of the queue (both added solely due to public demand). It's completely lock-free if you need it to be, and still lock-free in the common case otherwise.\n\n\nP.S. You come across as arrogant and a little bitter. You might want to work on that.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":2,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Sorry for the arrogance. The bitterness comes with the Guinness;)\u003cbr>I'm not looking for something. I write all the somethings I need.\u003cbr>Once in so often, I have a quick look at what people publish, just for the sake of it. And so, obviously, I did not go over all your code, and not all over the doc.\u003cbr>When you write small things, the testing is obviously smaller as well.\u003cbr>TBB's queue is horrible, just like yours. Boost's spsc_queue is good. Lokk at the simplicity - push and pop are just a few lines of code!\u003cbr>Actually I've written a similar queue (also based on ring buffer, push/pop may fail on lack of space) but I have several versions for sp/mp-sc/mc. Their mpmc queue is bad. Like I said, memory management is a separate topic and has to be left out of such containers.\u003cbr>All these guys don't go for ultimate performance but for fun and academic interests.\u003cbr>The guys who really push it are the HFT guys and they care less for the object model and unused features. We care only for the lowest latency in our very specific use case:)\u003c/p>","id":"2449769260","isHighlighted":false,"author":{"name":"Jacob","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar32.png","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-01-10T12:45:06","parent":2449520906,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Sorry for the arrogance. The bitterness comes with the Guinness;)\nI'm not looking for something. I write all the somethings I need.\nOnce in so often, I have a quick look at what people publish, just for the sake of it. And so, obviously, I did not go over all your code, and not all over the doc.\nWhen you write small things, the testing is obviously smaller as well.\nTBB's queue is horrible, just like yours. Boost's spsc_queue is good. Lokk at the simplicity - push and pop are just a few lines of code!\nActually I've written a similar queue (also based on ring buffer, push/pop may fail on lack of space) but I have several versions for sp/mp-sc/mc. Their mpmc queue is bad. Like I said, memory management is a separate topic and has to be left out of such containers.\nAll these guys don't go for ultimate performance but for fun and academic interests.\nThe guys who really push it are the HFT guys and they care less for the object model and unused features. We care only for the lowest latency in our very specific use case:)","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":2,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>I just thought I would point out that Boost's spsc_queue is simpler than MoodyCamel's because it is a spsc queue, and incapable of supporting mpmc. Also, a mpmc queue's solution does not require that the algorithm is simple. If you believe that the simplest solution is always best, then I suppose you would also refute Judy Arrays on principle.\u003c/p>\u003cp>I realize there isn't any reason for me to reply to your comment, as it is 2 months old and you are clearly a troll/etc, but I can't help myself.\u003c/p>","id":"2545923759","isHighlighted":false,"author":{"username":"peterdelevoryas","about":"","name":"Peter Delevoryas","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-03-01T18:51:01","profileUrl":"https://disqus.com/by/peterdelevoryas/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"198789523","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/peterdelevoryas.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/peterdelevoryas.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/peterdelevoryas.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-03-01T19:00:22","parent":2449769260,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I just thought I would point out that Boost's spsc_queue is simpler than MoodyCamel's because it is a spsc queue, and incapable of supporting mpmc. Also, a mpmc queue's solution does not require that the algorithm is simple. If you believe that the simplest solution is always best, then I suppose you would also refute Judy Arrays on principle.\n\nI realize there isn't any reason for me to reply to your comment, as it is 2 months old and you are clearly a troll/etc, but I can't help myself.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":3,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>One tiny thing I can share with you, just because you made such an effort:\u003cbr>You can write the simplest lockfree stack where any thread can push or pop, but (real life here ---&gt;)\u003cbr>1. give up on popping a single entry, coz in real life you have a single reader, you can pop them all in one go.\u003cbr>2. be intrusive. your users manage the entries.\u003cbr>After you've done that, I'm sure you can convert that to a queue.\u003c/p>","id":"2449776956","isHighlighted":false,"author":{"name":"Jacob","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar32.png","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-01-10T12:53:16","parent":2449769260,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"One tiny thing I can share with you, just because you made such an effort:\nYou can write the simplest lockfree stack where any thread can push or pop, but (real life here --->)\n1. give up on popping a single entry, coz in real life you have a single reader, you can pop them all in one go.\n2. be intrusive. your users manage the entries.\nAfter you've done that, I'm sure you can convert that to a queue.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":3,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I have to disagree about 1 at least. You sometimes and on very serious kind of application have to use multiple readers to have proper optimization. At least I do. Also I use this mpmc queue, mainly because I hate the boost one for slowing down quickly with lots of threads. Imagine running it under 2000 threads in cuda cores ! Just impossible.\u003c/p>","id":"2647830557","isHighlighted":false,"author":{"username":"zenohate","about":"","name":"\u7d76\u671b\u306e\u904b\u3073\u624b/Zenohate","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-06-09T07:35:14","profileUrl":"https://disqus.com/by/zenohate/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"160928010","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/zenohate.jpg","cache":"https://c.disquscdn.com/uploads/users/16092/8010/avatar32.jpg?1433835316"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/zenohate.jpg","cache":"https://c.disquscdn.com/uploads/users/16092/8010/avatar92.jpg?1433835316","large":{"permalink":"https://disqus.com/api/users/avatars/zenohate.jpg","cache":"https://c.disquscdn.com/uploads/users/16092/8010/avatar92.jpg?1433835316"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-28T18:49:01","parent":2449776956,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I have to disagree about 1 at least. You sometimes and on very serious kind of application have to use multiple readers to have proper optimization. At least I do. Also I use this mpmc queue, mainly because I hate the boost one for slowing down quickly with lots of threads. Imagine running it under 2000 threads in cuda cores ! Just impossible.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":4,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Wait, does this mean you use my queue with over a thousand threads? It was not designed for that at all :-)\u003c/p>","id":"2647895797","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-28T19:26:23","parent":2647830557,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Wait, does this mean you use my queue with over a thousand threads? It was not designed for that at all :-)","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":5,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>It's the most gracious solution I find so far. The other MP-MC are too slow. Btw they are just about 32 Producers, and well a lot of consumers\u003c/p>","id":"2647920368","isHighlighted":false,"author":{"username":"zenohate","about":"","name":"\u7d76\u671b\u306e\u904b\u3073\u624b/Zenohate","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-06-09T07:35:14","profileUrl":"https://disqus.com/by/zenohate/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"160928010","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/zenohate.jpg","cache":"https://c.disquscdn.com/uploads/users/16092/8010/avatar32.jpg?1433835316"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/zenohate.jpg","cache":"https://c.disquscdn.com/uploads/users/16092/8010/avatar92.jpg?1433835316","large":{"permalink":"https://disqus.com/api/users/avatars/zenohate.jpg","cache":"https://c.disquscdn.com/uploads/users/16092/8010/avatar92.jpg?1433835316"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-28T19:40:38","parent":2647895797,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"It's the most gracious solution I find so far. The other MP-MC are too slow. Btw they are just about 32 Producers, and well a lot of consumers","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":6,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Alright, cool. 32 is within the realm of normalcy.\u003c/p>","id":"2647923212","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-28T19:42:20","parent":2647920368,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Alright, cool. 32 is within the realm of normalcy.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":7,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Event based GPU computing at is finest. Almost all threads are CPU with a few exceptions.\u003c/p>","id":"2647936872","isHighlighted":false,"author":{"username":"ludoviclagouardette","about":"","name":"Ludovic Lagouardette","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-29T14:41:38","profileUrl":"https://disqus.com/by/ludoviclagouardette/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172119150","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/ludoviclagouardette.jpg","cache":"https://c.disquscdn.com/uploads/users/17211/9150/avatar32.jpg?1471474805"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/ludoviclagouardette.jpg","cache":"https://c.disquscdn.com/uploads/users/17211/9150/avatar92.jpg?1471474805","large":{"permalink":"https://disqus.com/api/users/avatars/ludoviclagouardette.jpg","cache":"https://c.disquscdn.com/uploads/users/17211/9150/avatar92.jpg?1471474805"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-28T19:49:55","parent":2647923212,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Event based GPU computing at is finest. Almost all threads are CPU with a few exceptions.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":8,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Sorry for the confusion, other disqus account\u003c/p>","id":"2647938436","isHighlighted":false,"author":{"username":"ludoviclagouardette","about":"","name":"Ludovic Lagouardette","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-08-29T14:41:38","profileUrl":"https://disqus.com/by/ludoviclagouardette/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"172119150","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/ludoviclagouardette.jpg","cache":"https://c.disquscdn.com/uploads/users/17211/9150/avatar32.jpg?1471474805"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/ludoviclagouardette.jpg","cache":"https://c.disquscdn.com/uploads/users/17211/9150/avatar92.jpg?1471474805","large":{"permalink":"https://disqus.com/api/users/avatars/ludoviclagouardette.jpg","cache":"https://c.disquscdn.com/uploads/users/17211/9150/avatar92.jpg?1471474805"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-28T19:50:49","parent":2647936872,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Sorry for the confusion, other disqus account","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":9,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>There were build errors in VS2015 (using V2012 sln). Possible to look into that?\u003c/p>","id":"2425490244","isHighlighted":false,"author":{"username":"stevetaw","about":"","name":"SteveTAW","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-12-25T08:59:56","profileUrl":"https://disqus.com/by/stevetaw/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"189235977","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/stevetaw.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/stevetaw.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/stevetaw.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-12-25T09:03:58","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"There were build errors in VS2015 (using V2012 sln). Possible to look into that?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Of course. What were the build errors? Can you open an issue on \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fcameron314%2Fconcurrentqueue%3A-J1PWGHnIP0YS1HcTFpz2ZOQySg&amp;cuid=1124748\" rel=\"nofollow noopener\" title=\"https://github.com/cameron314/concurrentqueue\">GitHub\u003c/a>?\u003c/p>","id":"2425654460","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-12-25T14:35:37","parent":2425490244,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Of course. What were the build errors? Can you open an issue on \u003ca href=\"https://github.com/cameron314/concurrentqueue\">GitHub\u003c/a>?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks. Submitted. Wish you a Merry Christmas and happy New Year 2016!\u003c/p>","id":"2426198904","isHighlighted":false,"author":{"username":"stevetaw","about":"","name":"SteveTAW","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-12-25T08:59:56","profileUrl":"https://disqus.com/by/stevetaw/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"189235977","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/stevetaw.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/stevetaw.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/stevetaw.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-12-26T02:54:27","parent":2425654460,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks. Submitted. Wish you a Merry Christmas and happy New Year 2016!","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks, you too :-) I'll look into it as soon as I can.\u003c/p>","id":"2426277931","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-12-26T05:12:49","parent":2426198904,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks, you too :-) I'll look into it as soon as I can.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":3,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>\u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fcameron314%2Fconcurrentqueue%2Fblob%2Fmaster%2FLICENSE.md%3A1TwV475w-VJJ5AqZgIYO6862bbU&amp;cuid=1124748\" rel=\"nofollow noopener\" title=\"https://github.com/cameron314/concurrentqueue/blob/master/LICENSE.md\">https://github.com/cameron3...\u003c/a>\u003c/p>\u003cp>I am not clear if this is a commercial or personal license due to this line? This is a two clause BSD license if I am not mistaken.\u003c/p>\u003cp> \"Boost queue (included in the benchmarks for comparison), Intel's TBB library (ditto), the CDSChecker tool (used for verification), the Relacy model checker (ditto), and Jeff Preshing's semaphore implementation (used in the blocking queue) which has a zlib license (embedded in blockingconcurrentqueue.h)?\u003c/p>\u003cp>This URL is interesting.\u003cbr>\u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fchoosealicense.com%2Flicenses%2Fbsd-2-clause%2F%3Agis2fbJdF2WiUe3XxY9dmxVfrLk&amp;cuid=1124748\" rel=\"nofollow noopener\" title=\"http://choosealicense.com/licenses/bsd-2-clause/\">http://choosealicense.com/l...\u003c/a>  (permits commercial use)\u003cbr>with parent URL.\u003cbr>\u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fchoosealicense.com%2Flicenses%2F%3AmXopB2jBYBlTmReLG7CDPerLruk&amp;cuid=1124748\" rel=\"nofollow noopener\" title=\"http://choosealicense.com/licenses/\">http://choosealicense.com/l...\u003c/a>\u003c/p>\u003cp>Usually BSD license allows for commercial use. Can you clarify?\u003c/p>","id":"2161026111","isHighlighted":false,"author":{"username":"virgoptrex","about":"","name":"virgoptrex","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2012-11-17T13:56:39","profileUrl":"https://disqus.com/by/virgoptrex/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"36730387","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar32.jpg?1361761297"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar92.jpg?1361761297","large":{"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar92.jpg?1361761297"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-07-28T11:54:49","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"https://github.com/cameron314/concurrentqueue/blob/master/LICENSE.md\n\nI am not clear if this is a commercial or personal license due to this line? This is a two clause BSD license if I am not mistaken.\n\n\n \"Boost queue (included in the benchmarks for comparison), Intel's TBB library (ditto), the CDSChecker tool (used for verification), the Relacy model checker (ditto), and Jeff Preshing's semaphore implementation (used in the blocking queue) which has a zlib license (embedded in blockingconcurrentqueue.h)? \n\nThis URL is interesting.\nhttp://choosealicense.com/licenses/bsd-2-clause/  (permits commercial use)\nwith parent URL.\nhttp://choosealicense.com/licenses/\n\nUsually BSD license allows for commercial use. Can you clarify?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":["links"],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I've licensed my own code under simplified BSD (2-clause), which indeed allows commercial use. The core queue itself (concurrentqueue.h) has no other dependencies, and so is solely licensed under BSD and can be used commercially.\u003c/p>\u003cp>The blocking version of the queue uses semaphore code adapted from what Jeff Preshing published under the zlib license, which also allows commercial use.\u003c/p>\u003cp>However, there's other code in the repository than just my own and Jeff's; the other queues I use for benchmarking against, for example, were not written by me, and have their own separate licenses as you've seen. The same goes for the testing tools. If you don't intend to use the parts of the test or benchmarking code that I haven't written commercially (and I don't see any reason why you would want to), then you're fine.\u003c/p>\u003cp>I hope this clears things up?\u003c/p>","id":"2161120557","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-07-28T13:07:39","parent":2161026111,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I've licensed my own code under simplified BSD (2-clause), which indeed allows commercial use. The core queue itself (concurrentqueue.h) has no other dependencies, and so is solely licensed under BSD and can be used commercially.\n\nThe blocking version of the queue uses semaphore code adapted from what Jeff Preshing published under the zlib license, which also allows commercial use.\n\nHowever, there's other code in the repository than just my own and Jeff's; the other queues I use for benchmarking against, for example, were not written by me, and have their own separate licenses as you've seen. The same goes for the testing tools. If you don't intend to use the parts of the test or benchmarking code that I haven't written commercially (and I don't see any reason why you would want to), then you're fine.\n\n\n\nI hope this clears things up?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks for the clarification. I don't intend to use bench marking. So basically if I drop those two header files (by you and Jeff) in my code along with your respective license files and delete all other folders to be on safe side then I should be good. That is my understanding. Correct?\u003c/p>","id":"2162412209","isHighlighted":false,"author":{"username":"virgoptrex","about":"","name":"virgoptrex","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2012-11-17T13:56:39","profileUrl":"https://disqus.com/by/virgoptrex/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"36730387","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar32.jpg?1361761297"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar92.jpg?1361761297","large":{"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar92.jpg?1361761297"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-07-29T01:42:24","parent":2161120557,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks for the clarification. I don't intend to use bench marking. So basically if I drop those two header files (by you and Jeff) in my code along with your respective license files and delete all other folders to be on safe side then I should be good. That is my understanding. Correct?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":2,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Yep!\u003c/p>\u003cp>In fact, you don't have to go that far -- everything except tests/CDSChecker/model-checker, tests/relacy/relacy, benchmarks/boost, and benchmarks/tbb was written by me (with the exception of Jeff's semaphore code) and is under the BSD license. I think perhaps that's the clearest way of stating things (I should probably update the readme!).\u003c/p>","id":"2162498428","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-07-29T02:37:05","parent":2162412209,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Yep!\n\n\nIn fact, you don't have to go that far -- everything except tests/CDSChecker/model-checker, tests/relacy/relacy, benchmarks/boost, and benchmarks/tbb was written by me (with the exception of Jeff's semaphore code) and is under the BSD license. I think perhaps that's the clearest way of stating things (I should probably update the readme!).","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":3,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Cool! Awesome! Thanks for being crystal clear.\u003c/p>","id":"2166467197","isHighlighted":false,"author":{"username":"virgoptrex","about":"","name":"virgoptrex","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2012-11-17T13:56:39","profileUrl":"https://disqus.com/by/virgoptrex/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"36730387","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar32.jpg?1361761297"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar92.jpg?1361761297","large":{"permalink":"https://disqus.com/api/users/avatars/virgoptrex.jpg","cache":"https://c.disquscdn.com/uploads/users/3673/387/avatar92.jpg?1361761297"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-07-31T02:51:23","parent":2162498428,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Cool! Awesome! Thanks for being crystal clear.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":4,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Cameron,\u003c/p>\u003cp>Firstly congratulations for your implementation, it is very useful. \u003cbr>I have a question: There is a clear (reset) function?\u003c/p>\u003cp>Thanks in advance\u003c/p>","id":"2056792887","isHighlighted":false,"author":{"username":"antoniocarlosnazarjnior","about":"","name":"Antonio Carlos Nazar\u00e9 J\u00fanior","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-06-01T19:50:14","profileUrl":"https://disqus.com/by/antoniocarlosnazarjnior/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"159974045","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/antoniocarlosnazarjnior.jpg","cache":"https://c.disquscdn.com/uploads/users/15997/4045/avatar32.jpg?1438906921"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/antoniocarlosnazarjnior.jpg","cache":"https://c.disquscdn.com/uploads/users/15997/4045/avatar92.jpg?1438906921","large":{"permalink":"https://disqus.com/api/users/avatars/antoniocarlosnazarjnior.jpg","cache":"https://c.disquscdn.com/uploads/users/15997/4045/avatar92.jpg?1438906921"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-06-01T19:50:23","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi Cameron,\n\nFirstly congratulations for your implementation, it is very useful. \nI have a question: There is a clear (reset) function?\n\nThanks in advance","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>There is not, currently. You'll have to manually pump the queue until it's empty, for now.\u003c/p>","id":"2056856778","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-06-01T20:22:03","parent":2056792887,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"There is not, currently. You'll have to manually pump the queue until it's empty, for now.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>can i use it without c++11 and is your lib support arm processors?\u003c/p>","id":"2052868480","isHighlighted":false,"author":{"username":"disqus_j3TN0f4CuC","about":"","name":"Mohsen","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-05-30T07:00:48","profileUrl":"https://disqus.com/by/disqus_j3TN0f4CuC/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"159661622","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_j3TN0f4CuC.jpg","cache":"https://c.disquscdn.com/uploads/users/15966/1622/avatar32.jpg?1432969257"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_j3TN0f4CuC.jpg","cache":"https://c.disquscdn.com/uploads/users/15966/1622/avatar92.jpg?1432969257","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_j3TN0f4CuC.jpg","cache":"https://c.disquscdn.com/uploads/users/15966/1622/avatar92.jpg?1432969257"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-30T07:00:56","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"can i use it without c++11 and is your lib support arm processors?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I'm afraid it absolutely requires a C++11 compiler.\u003cbr>I have not tested it on ARM, but it should work correctly -- the algorithms and implementation are processor-agnostic.\u003c/p>","id":"2053475787","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-30T17:24:37","parent":2052868480,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I'm afraid it absolutely requires a C++11 compiler.\nI have not tested it on ARM, but it should work correctly -- the algorithms and implementation are processor-agnostic.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I stumbled over your great implementation for a MPMC data structure and played around a little with it. It seems really well done and with a lot of precious details in code. I was wondering if this implementation could be easily changed from a queue (FIFO) to a stack (LIFO)?\u003c/p>","id":"2036510443","isHighlighted":false,"author":{"name":"Johannes","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar32.png","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-20T22:03:11","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I stumbled over your great implementation for a MPMC data structure and played around a little with it. It seems really well done and with a lot of precious details in code. I was wondering if this implementation could be easily changed from a queue (FIFO) to a stack (LIFO)?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks :-) Unfortunately, the short answer is no. The code is extremely complex, and very much tied to the specifics of the queue FIFO semantics.\u003c/p>","id":"2036516931","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-20T22:07:51","parent":2036510443,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks :-) Unfortunately, the short answer is no. The code is extremely complex, and very much tied to the specifics of the queue FIFO semantics.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Too bad, I was happy that I have found such a great implementation - just the order of elements is the other way round... Anyways, thanks again for your great work!\u003c/p>","id":"2036539440","isHighlighted":false,"author":{"name":"Johannes","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar32.png","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-20T22:24:53","parent":2036516931,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Too bad, I was happy that I have found such a great implementation - just the order of elements is the other way round... Anyways, thanks again for your great work!","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":2,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey Cameron, I'm curious - have you attempted to benchmark your concurrent queue against facebook's Folly MPMCQueue? I would be very tempted to see how they perform against one another, especially given how lightweight your implementation is compared to that of Folly.\u003c/p>","id":"2016049516","isHighlighted":false,"author":{"username":"ThoraxImpailor","about":"","name":"ThoraxImpailor","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-03-21T20:53:22","profileUrl":"https://disqus.com/by/ThoraxImpailor/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"8305310","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/ThoraxImpailor.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/ThoraxImpailor.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/ThoraxImpailor.jpg","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-09T23:43:01","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hey Cameron, I'm curious - have you attempted to benchmark your concurrent queue against facebook's Folly MPMCQueue? I would be very tempted to see how they perform against one another, especially given how lightweight your implementation is compared to that of Folly.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>No, I have not -- I didn't know it existed! I'll open an issue on GitHub to add it to the benchmark code. Not sure I would call my implementation \"light\" though ;-)\u003c/p>","id":"2016921677","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-10T16:35:29","parent":2016049516,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"No, I have not -- I didn't know it existed! I'll open an issue on GitHub to add it to the benchmark code. Not sure I would call my implementation \"light\" though ;-)","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Cameron,\u003c/p>\u003cp>The lock-free means that there is no blocking when queue is empty ?\u003cbr>Is there also a feature which makes the Queue get blocked when empty ?\u003c/p>\u003cp>Thanks,\u003cbr>Ran\u003c/p>","id":"1999569571","isHighlighted":false,"author":{"username":"Ranshalit","about":"","name":"ran","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-10-10T20:37:47","profileUrl":"https://disqus.com/by/Ranshalit/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"125214668","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/Ranshalit.jpg","cache":"https://c.disquscdn.com/uploads/users/12521/4668/avatar32.jpg?1430549819"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/Ranshalit.jpg","cache":"https://c.disquscdn.com/uploads/users/12521/4668/avatar92.jpg?1430549819","large":{"permalink":"https://disqus.com/api/users/avatars/Ranshalit.jpg","cache":"https://c.disquscdn.com/uploads/users/12521/4668/avatar92.jpg?1430549819"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-02T16:38:19","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi Cameron,\n\nThe lock-free means that there is no blocking when queue is empty ?\nIs there also a feature which makes the Queue get blocked when empty ?\n\n\nThanks,\nRan","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Lock-free simply means there are no locks involved in the common operations, and is independent of blocking/non-blocking.\u003c/p>\u003cp>I did in fact recently add a blocking version of the queue (in the 'blockingconcurrentqueue.h' header file) that provides `wait_dequeue` methods that block while the queue is empty.\u003c/p>","id":"1999869820","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-05-02T20:13:32","parent":1999569571,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Lock-free simply means there are no locks involved in the common operations, and is independent of blocking/non-blocking.\n\n\nI did in fact recently add a blocking version of the queue (in the 'blockingconcurrentqueue.h' header file) that provides `wait_dequeue` methods that block while the queue is empty.","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>So I'm trying to use your queue as a replacement for a tbb::concurrent_bounded_queue by putting a semaphore wait in front of every try_dequeue and a semaphore post after every successful try_enqueue. Sadly, when I do this, the program hangs. I don't understand what could be going wrong here -- the semaphore's just counting the number of elements in the queue, fer cryin' out loud. Has anyone else tried this and gotten it to work?\u003c/p>","id":"1949604766","isHighlighted":false,"author":{"name":"Bill T.","url":"","profileUrl":"","emailHash":"","avatar":{"small":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar32.png","cache":"//a.disquscdn.com/1527291045/images/noavatar32.png"},"large":{"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"permalink":"//a.disquscdn.com/1527291045/images/noavatar92.png","cache":"//a.disquscdn.com/1527291045/images/noavatar92.png"},"signedUrl":"","isAnonymous":true},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-04-06T20:19:51","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"So I'm trying to use your queue as a replacement for a tbb::concurrent_bounded_queue by putting a semaphore wait in front of every try_dequeue and a semaphore post after every successful try_enqueue. Sadly, when I do this, the program hangs. I don't understand what could be going wrong here -- the semaphore's just counting the number of elements in the queue, fer cryin' out loud. Has anyone else tried this and gotten it to work?","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":0,"points":0,"moderationLabels":["anonymous"],"isEdited":false,"sb":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I'm presently working on a blocking version (using a semaphore), which should be ready soonish. In the meantime, I suggest opening an issue on GitHub with some sample code. I'll take a look at it.\u003c/p>\u003cp>The hang is likely due to a misuse of try_enqueue, which has happened several times lately. It's my fault for not properly documenting it (that's on my near-term TODO list too). It's entirely possible that try_enqueue never returns success (since the queue is empty by default and thus no attempts to try_enqueue ever succeed), in which case all blocking attempts to dequeue will wait forever. Does it do anything if you remove the semaphore part?\u003c/p>\u003cp>Apart from that, there's no guarantee that try_dequeue will always succeed even if the semaphore wait was successful -- the queue is only eventually consistent, so a correct blocking implementation must call try_dequeue in a loop until a value is found after acquiring the semaphore. This will make a difference under contention (your semaphore could become out of sync with the actual number of elements in the queue otherwise, again leading to a potential hang).\u003c/p>","id":"1949623892","isHighlighted":false,"author":{"username":"cameron314","about":"","name":"Cameron","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-11-12T05:42:29","profileUrl":"https://disqus.com/by/cameron314/","url":"http://moodycamel.com","location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com&key=M3kxZUPIOsizxVPa2TyxhQ","isPrimary":true,"isAnonymous":false,"id":"18992720","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar32.jpg?1321077712"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712","large":{"permalink":"https://disqus.com/api/users/avatars/cameron314.jpg","cache":"https://c.disquscdn.com/uploads/users/1899/2720/avatar92.jpg?1321077712"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-04-06T20:30:45","parent":1949604766,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I'm presently working on a blocking version (using a semaphore), which should be ready soonish. In the meantime, I suggest opening an issue on GitHub with some sample code. I'll take a look at it.\n\n\nThe hang is likely due to a misuse of try_enqueue, which has happened several times lately. It's my fault for not properly documenting it (that's on my near-term TODO list too). It's entirely possible that try_enqueue never returns success (since the queue is empty by default and thus no attempts to try_enqueue ever succeed), in which case all blocking attempts to dequeue will wait forever. Does it do anything if you remove the semaphore part?\n\n\nApart from that, there's no guarantee that try_dequeue will always succeed even if the semaphore wait was successful -- the queue is only eventually consistent, so a correct blocking implementation must call try_dequeue in a loop until a value is found after acquiring the semaphore. This will make a difference under contention (your semaphore could become out of sync with the actual number of elements in the queue otherwise, again leading to a potential hang).","canVote":false,"thread":"3196815547","forum":"moodycamel","depth":1,"points":0,"moderationLabels":[],"isEdited":true,"sb":false}],"thread":{"feed":"https://moodycamel.disqus.com/a_fast_general_purpose_lock_free_queue_for_c/latest.rss","author":"18992720","dislikes":0,"likes":4,"message":"","isSpam":false,"createdAt":"2014-11-06T05:01:35","category":"1146546","clean_title":"A Fast General Purpose Lock-Free Queue for C","id":"3196815547","signedLink":"http://disq.us/?url=http%3A%2F%2Fmoodycamel.com%2Fblog%2F2014%2Fa-fast-general-purpose-lock-free-queue-for-c%2B%2B&key=XoFj654nc9T-odLLMTlPyA","isDeleted":false,"hasStreaming":false,"raw_message":"","isClosed":false,"link":"http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++","slug":"a_fast_general_purpose_lock_free_queue_for_c","forum":"moodycamel","identifiers":[],"posts":79,"moderators":[18992720],"validateAllPosts":false,"title":"\n\nA Fast General Purpose Lock-Free Queue for C++\n\n","highlightedPost":null}},"order":"desc"}</script>


    <div id="fixed-content"></div>


    
        
<script type="text/json" id="disqus-urls">{
    "root":"//disqus.com",
    "next":"https://c.disquscdn.com/next/current/embed"
}</script>

        
        <script>!function () {
            var d = document;
            var toH = d.head.appendChild.bind(d.head);

            var v = window.location.href.match(/[#&?]version=([0-9a-f]{32})/);
            var src = 'https://c.disquscdn.com/next/embed/lounge.load';
            if (v)
                src += '.' + v[1];
            src += '.js';

            var s = d.createElement('script');
            s.crossOrigin = 'anonymous';
            s.id = 'bootstrap-script';
            s.setAttribute('data-app', 'lounge');
            s.src = src;
            toH(s);

            var m = d.createElement('meta');
            m.setAttribute('http-equiv', 'Content-Security-Policy');
            m.setAttribute('content', "script-src https:;");
            toH(m);
        }();</script>
    


<script src="a_data/common.js"></script><div id="layout" data-tracking-area="layout"><div id="onboard" data-tracking-area="onboard"><div></div></div><div id="highlighted-post" data-tracking-area="highlighted" class="highlighted-post" style="display: none;"></div><div id="global-alert"></div><div id="tos__container"></div><header id="main-nav" data-tracking-area="main-nav"><nav class="nav nav-primary"><ul><li class="nav-tab nav-tab--primary tab-conversation active" data-role="post-count"><a class="publisher-nav-color"><span class="comment-count">79 comments</span><span class="comment-count-placeholder">Comments</span></a></li><li class="nav-tab nav-tab--primary tab-community"><a href="https://disqus.com/home/forums/moodycamel/" class="publisher-nav-color" data-action="community-sidebar" data-forum="moodycamel" id="community-tab" name="moodycamel.com"><span class="community-name"><strong>moodycamel.com</strong></span><strong class="community-name-placeholder">Community</strong></a></li><li class="nav-tab nav-tab--primary dropdown user-menu" data-role="logout"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="menuitem" name="Login"><span class="dropdown-toggle-wrapper"><span>Login</span> </span> <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#" data-action="auth:disqus">Disqus</a></li><li><a href="#" data-action="auth:facebook">Facebook</a></li><li><a href="#" data-action="auth:twitter">Twitter</a></li><li><a href="#" data-action="auth:google">Google</a></li></ul></li><li class="nav-tab nav-tab--primary notification-menu unread" data-role="notification-menu"><a href="https://disqus.com/home/inbox/" class="notification-container" data-action="home" data-home-path="home/inbox/"><span class="notification-icon icon-comment" aria-hidden="true"></span><span class="notification-count" data-role="notification-count">1</span></a></li></ul></nav></header><section id="conversation" data-role="main" data-tracking-area="main"><div class="nav nav-secondary" data-tracking-area="secondary-nav"><ul><li id="recommend-button" class="nav-tab nav-tab--secondary recommend dropdown"><div class="thread-likes"><div><a href="#" data-action="recommend" title="Recommend this discussion" class="dropdown-toggle "><span class="label label-default"><span class="recommend-icon icon-heart-empty"></span> Recommend</span><span class="label label-recommended"><span class="recommend-icon icon-heart"></span> Recommended</span> <span class="label label-count">4</span></a><ul class="dropdown-menu dropdown-menu--coachmark"><li><div><h2 class="coachmark__heading">Discussion Recommended!</h2><p class="coachmark__description">Recommending means this is a discussion worth sharing. It gets shared to your followers' Disqus feeds, and gives the creator kudos!</p></div> <a href="https://disqus.com/home/?utm_source=disqus_embed&amp;utm_content=recommend_btn" class="btn btn-primary coachmark__button" target="_blank">Find More Discussions</a></li></ul></div></div></li><li id="thread-share-menu" class="nav-tab nav-tab--secondary dropdown share-menu hidden-sm" role="menuitem"><a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Share"><span class="icon-export"></span> <span class="label">Share</span></a><ul class="share-menu dropdown-menu"><li><div class="share-menu__label">Share this discussion on</div><ul><li class="twitter"><a data-action="share:twitter" href="#">Twitter</a></li><li class="facebook"><a data-action="share:facebook" href="#">Facebook</a></li></ul></li></ul></li><li data-role="post-sort" class="nav-tab nav-tab--secondary dropdown sorting pull-right"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Sort by Newest<span class="caret"></span></a><ul class="dropdown-menu pull-right"><li class=""><a href="#" data-action="sort" data-sort="popular">Best<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class="selected"><a href="#" data-action="sort" data-sort="desc">Newest<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="#" data-action="sort" data-sort="asc">Oldest<i aria-hidden="true" class="icon-checkmark"></i></a></li></ul></li></ul></div><div id="posts"><div id="form" class="textarea-wrapper--top-level"><form class="reply"><div class="postbox"><div role="alert"></div><div class="avatar"><span class="user"><img data-role="user-avatar" src="a_data/noavatar92.png" alt="Avatar"></span></div><div class="textarea-wrapper" data-role="textarea" dir="auto"><div><span class="placeholder">Join the discussion…</span><div class="textarea" tabindex="0" role="textbox" aria-multiline="true" data-role="editable" style="overflow: auto; overflow-wrap: break-word; max-height: 350px;" aria-label="Join the discussion…" contenteditable="true"><p><br></p></div><div style="display: none;"><ul class="user-mention__list"><li class="header user-mention__header"><h5>in this conversation</h5></li></ul></div></div><div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none;"><div class="drag-text">⬇ Drag and drop your images here to upload them.</div></div><div class="edit-alert" role="postbox-alert"></div><div class="post-actions"><ul class="wysiwyg"></ul></div></div><div data-role="login-form"><div><div><section class="auth-section logged-out__display"><div class="connect"><h6>Log in with</h6><ul data-role="login-menu" class="services login-buttons"><li class="auth-disqus"><button type="button" data-action="auth:disqus" title="Disqus" class="connect__button"><i class="icon-disqus"></i></button></li><li class="auth-facebook"><button type="button" data-action="auth:facebook" title="Facebook" class="connect__button"><i class="icon-facebook-circle"></i></button></li><li class="auth-twitter"><button type="button" data-action="auth:twitter" title="Twitter" class="connect__button"><i class="icon-twitter-circle"></i></button></li><li class="auth-google"><button type="button" data-action="auth:google" title="Google" class="connect__button"><i class="icon-google-plus-circle"></i></button></li></ul></div><div class="guest"><h6 class="guest-form-title"><span class="register-text"> or sign up with Disqus </span><span class="guest-text"> or pick a name </span></h6> <div class="help-tooltip__wrapper help-icon" tabindex="0"><div id="rules" class="tooltip show help-tooltip"><h3 class="help-tooltip__heading">Disqus is a discussion network</h3><ul class="help-tooltip__list"><li><span>Disqus never moderates or censors. The rules on this community are its own.</span></li><li><span>Don't be a jerk or do anything illegal. Everything is easier that way.</span></li></ul><p class="clearfix"><a href="https://docs.disqus.com/kb/terms-and-policies/" class="btn btn-small help-tooltip__button" target="_blank">Read full terms and conditions</a></p></div></div><p class="input-wrapper"><input dir="auto" placeholder="Name" name="display_name" id="view101_display_name" maxlength="30" class="input--text" aria-label="name" type="text"></p><div class="guest-details " data-role="guest-details"><p class="input-wrapper"><input dir="auto" placeholder="Email" name="email" id="view101_email" class="input--text" aria-label="email" type="email"></p><p class="input-wrapper"><input dir="auto" disabled="disabled" class="register-text input--text" placeholder="Password" name="password" aria-label="password" id="view101_password" type="text"></p><div class="acceptance-wrapper"><p><label><input name="tos" type="checkbox"><span class="spacing-left-small">I agree to Disqus' <a href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service" target="_blank" rel="noopener noreferrer">Terms of Service</a></span></label></p><p><label><input name="privacy-policy" type="checkbox"><span class="spacing-left-small">I
 agree to Disqus' processing of email and IP address, and the use of 
cookies, to facilitate my authentication and posting of comments, 
explained further in the <a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" target="_blank" rel="noopener noreferrer">Privacy Policy</a></span></label></p></div><div class="guest-checkbox"><label><input name="author-guest" type="checkbox"> I'd rather post as a guest</label></div><div class="proceed" data-role="submit-btn-container"><div><button type="submit" class="proceed__button btn submit" aria-label="Post" disabled="disabled"><span class="icon-proceed"></span><div class="spinner"></div></button><button type="submit" class="proceed__button btn next" aria-label="Next" disabled="disabled"><span class="icon-proceed"></span><div class="spinner"></div></button></div></div></div></div></section></div></div></div></div></form></div><button class="alert alert--realtime" style="display: none;" data-role="realtime-notification"></button><div id="email-signup"></div><div id="no-posts" style="display: none;"></div><ul id="post-list" class="post-list"><li class="post" id="post-3413790219"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/dispayname/" data-action="profile" data-username="dispayname" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="161387292" src="a_data/avatar92_003.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/dispayname/" data-action="profile" data-username="dispayname" target="_blank" rel="noopener noreferrer">Dispay Name</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3413790219" data-role="relative-time" class="time-ago" title="Wednesday, July 12, 2017 6:28 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Have
 you compared performance with the fastflow MPMC queue? They use SPSC 
queues per producer and per consumer, and use an arbiter thread to 
multuplex them. The SPSC queues are extremely fast since they don't use 
atomic operations and a thread reads/writes either only the head or only
 the tail, avoiding sharing, and also avoiding any CPU fences on x86.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1kghde3"></li></ul></li><li class="realtime" data-role="realtime-notification:3413790219"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3414619889"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3413790219" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Dispay Name</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3414619889" data-role="relative-time" class="time-ago" title="Thursday, July 13, 2017 9:23 AM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>No, I haven't. But yes, using SPSC queues between pairs of cores is ideal where possible.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1kgz5kh"></li></ul></li><li class="realtime" data-role="realtime-notification:3414619889"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-3184195473"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/JC_15/" data-action="profile" data-username="JC_15" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="158816189" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/JC_15/" data-action="profile" data-username="JC_15" target="_blank" rel="noopener noreferrer">JC</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3184195473" data-role="relative-time" class="time-ago" title="Friday, March 3, 2017 5:21 AM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hello
 Cameron, is there a way in which we can dequeue the latest item from 
the ConcurrentQueue (i.e the last item that was entered). I think the 
dequeue function always returns the first item entered in the queue... 
Thanks,</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1gnscy9"></li></ul></li><li class="realtime" data-role="realtime-notification:3184195473"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3184328425"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3184195473" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> JC</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3184328425" data-role="relative-time" class="time-ago" title="Friday, March 3, 2017 7:50 AM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Sorry,
 this isn't possible. The queue implementation is highly special 
purpose, and can't be adapted with e.g. stack functionality. </p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1gnv7jd"></li></ul></li><li class="realtime" data-role="realtime-notification:3184328425"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3184387251"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/JC_15/" data-action="profile" data-username="JC_15" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="158816189" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/JC_15/" data-action="profile" data-username="JC_15" target="_blank" rel="noopener noreferrer">JC</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3184328425" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3184387251" data-role="relative-time" class="time-ago" title="Friday, March 3, 2017 8:32 AM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks...I
 guess the only solution will be to store the item getting enqued into a
 local variable. But then will have to synchronize access to the 
variable...crude solution but will work i guess....</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1gnwgxf"></li></ul></li><li class="realtime" data-role="realtime-notification:3184387251"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li><li class="post" id="post-3098181144"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_7XqKPXBZnm/" data-action="profile" data-username="disqus_7XqKPXBZnm" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="114903755" src="a_data/avatar92_002.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_7XqKPXBZnm/" data-action="profile" data-username="disqus_7XqKPXBZnm" target="_blank" rel="noopener noreferrer">wdswd</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3098181144" data-role="relative-time" class="time-ago" title="Friday, January 13, 2017 5:36 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Can you do a benchmark for android devices please ? using android ndk</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1f8krvc"></li></ul></li><li class="realtime" data-role="realtime-notification:3098181144"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3098184512"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3098181144" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> wdswd</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3098184512" data-role="relative-time" class="time-ago" title="Friday, January 13, 2017 5:39 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>No, sorry. No time and no Android development environment set up.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1f8kugw"></li></ul></li><li class="realtime" data-role="realtime-notification:3098184512"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-2980496649"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_w9sOOsNeSb/" data-action="profile" data-username="disqus_w9sOOsNeSb" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="32390672" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_w9sOOsNeSb/" data-action="profile" data-username="disqus_w9sOOsNeSb" target="_blank" rel="noopener noreferrer">john</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2980496649" data-role="relative-time" class="time-ago" title="Wednesday, November 2, 2016 12:22 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You are a God among mortals sir! This is really convenient!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1daidxl"></li></ul></li><li class="realtime" data-role="realtime-notification:2980496649"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li><li class="post" id="post-2754527325"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/marcopagliaricci/" data-action="profile" data-username="marcopagliaricci" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="213144148" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/marcopagliaricci/" data-action="profile" data-username="marcopagliaricci" target="_blank" rel="noopener noreferrer">Marco Pagliaricci</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2754527325" data-role="relative-time" class="time-ago" title="Tuesday, June 28, 2016 5:22 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thank
 you for posting this. Awesome data structure and ideas. May I point you
 to test your concurrent queue against this data structure described in 
the link below? -&gt; <a href="http://disq.us/url?url=http%3A%2F%2Fwww.linuxjournal.com%2Fcontent%2Flock-free-multi-producer-multi-consumer-queue-ring-buffer%3ASH5To1bxdw5Mg8RKBT0UZhKDnB8&amp;cuid=1124748" rel="nofollow noopener" title="http://www.linuxjournal.com/content/lock-free-multi-producer-multi-consumer-queue-ring-buffer">http://www.linuxjournal.com...</a>
 I think it will be an interesting fight, tough I think your queue would
 be much faster. Also, how exactly did you made the benchmarks? Is 
benchmark code included in github? Cheers!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/19jz2vx"></li></ul></li><li class="realtime" data-role="realtime-notification:2754527325"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2754733538"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2754527325" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Marco Pagliaricci</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2754733538" data-role="relative-time" class="time-ago" title="Tuesday, June 28, 2016 8:42 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Interesting!
 No, I don't think I'll add it to the benchmarks. It's not very portable
 code as is (it assumes a GCC compliant compiler). Its design 
constraints are also significantly different from those I chose 
(ring-buffer vs dynamically expanding, number of producers/consumers 
known in advance vs adaptable, etc.), which would make the comparison a 
little unfair for both queues.</p><p>The benchmark code <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fcameron314%2Fconcurrentqueue%2Ftree%2Fmaster%2Fbenchmarks%3AN20hTIrIvSl9N4Rqmc617JWVACo&amp;cuid=1124748" rel="nofollow noopener" title="https://github.com/cameron314/concurrentqueue/tree/master/benchmarks">is indeed on GitHub</a>,
 so feel free to experiment with it yourself (it's not too hard to add 
another queue, it basically just requires filling out some tables at the
 top and writing the glue code to give it a consistent interface).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/19k3i02"></li></ul></li><li class="realtime" data-role="realtime-notification:2754733538"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2755750316"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/marcopagliaricci/" data-action="profile" data-username="marcopagliaricci" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="213144148" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/marcopagliaricci/" data-action="profile" data-username="marcopagliaricci" target="_blank" rel="noopener noreferrer">Marco Pagliaricci</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2754733538" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2755750316" data-role="relative-time" class="time-ago" title="Tuesday, June 28, 2016 6:48 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks
 for your reply. I agree that those 2 queues are indeed very different. I
 have a request: in a previous post, explaining the internal functioning
 of your MPMC concurrent queue, you said that it is basically composed 
of N SPMC queues. I think would be useful for users to have those SPMC 
queues to be used as a separate tool. Also, I find very useful MPSC 
queues, because it is very common to have one thread which loops and 
consumes tasks coming from N other threads. What are your thoughts on 
having those optimized SPMC and MPSC queues? Do you plan to spend some 
time on that?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/19kpajw"></li></ul></li><li class="realtime" data-role="realtime-notification:2755750316"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2755848978"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2755750316" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Marco Pagliaricci</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2755848978" data-role="relative-time" class="time-ago" title="Tuesday, June 28, 2016 8:06 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>My
 MPMC queue can be used as a SPMC queue with almost no overhead. I do 
think it's a good idea to have separate optimized implementations for 
SPMC and MPSC, as well as a MPMC ring-buffer -- but I don't have much 
time ;-) Someday, maybe, when I'm in the mood!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/19kreoi"></li></ul></li><li class="realtime" data-role="realtime-notification:2755848978"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li></ul></li><li class="post" id="post-2581027216"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/kiddinglife/" data-action="profile" data-username="kiddinglife" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="201188582" src="a_data/avatar92_004.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/kiddinglife/" data-action="profile" data-username="kiddinglife" target="_blank" rel="noopener noreferrer">Jake Zhang</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2581027216" data-role="relative-time" class="time-ago" title="Monday, March 21, 2016 6:38 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>i
 agree with Jacob's opinion that prefer to simple spsc lock-free queue. I
 saw many people are using very simple spsp queue that comes from Linux 
Kernel. Any queue that is implemented based on CAS still has 
race-condition happening at hardware level. But linux queue is a 100% 
"lock-free" queue where two threads <br>can run 100% independently.<br>In addition, what I want to say is that you can use more than one spsc queue to replace mpmq queue.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/16oodcg"></li></ul></li><li class="realtime" data-role="realtime-notification:2581027216"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2635945357"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2581027216" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Jake Zhang</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2635945357" data-role="relative-time" class="time-ago" title="Thursday, April 21, 2016 3:40 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>There's
 always a race at the hardware level. It's a shared data structure, thus
 at some point memory has to be shared between the two threads. Sharing 
memory leads to races in the cache hardware, even if it's only reading 
memory that the other thread is only writing.</p><p>"Lock-free" means 
just that, a CAS doesn't lock anything in any meaningful sense because 
it cannot be interrupted at the hardware level -- it is truly atomic 
(though possibly slower under contention). My queue, by the way, doesn't
 use CAS on the fast path, but rather FAA.</p><p>Anyway, a SPSC queue is
 obviously simpler than a MPMC queue. If all you need is SPSC, or series
 of SPSCs, then of course, use one that's specifically SPSC instead 
(like the <a href="http://disq.us/url?url=http%3A%2F%2Fmoodycamel.com%2Fblog%2F2013%2Fa-fast-lock-free-queue-for-c%2B%2B%3AqiyUCbCeZ4TI_m1EfBqf5V6MclU&amp;cuid=1124748" rel="nofollow noopener" title="http://moodycamel.com/blog/2013/a-fast-lock-free-queue-for-c++">one I wrote</a>).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17ldggd"></li></ul></li><li class="realtime" data-role="realtime-notification:2635945357"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3164071748"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/dmitriykanareykin/" data-action="profile" data-username="dmitriykanareykin" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="242852897" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/dmitriykanareykin/" data-action="profile" data-username="dmitriykanareykin" target="_blank" rel="noopener noreferrer">Dmitriy Kanareykin</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2635945357" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3164071748" data-role="relative-time" class="time-ago" title="Sunday, February 19, 2017 1:22 PM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Unfortunately, if you look deeper into the CAS x86 machine code, you'll find</p><p>lock cmpxchg</p><p>and if you even look deeper into an "atomic increment", you'll find</p><p>lock inc</p><p>or</p><p>lock xadd</p><p>So,
 it's quite ironic calling the final implementation "lock free". Yes, 
these are the hardware-level locks, they cannot be interrupted, but the 
name stands for itself :) Also they introduce additional delays due to 
cache line locking for the time of operation. Moreover, Windows SRW 
locks use just one lock cmpxchg instruction per operation.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1gbt1dw"></li></ul></li><li class="realtime" data-role="realtime-notification:3164071748"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-3165352306"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3164071748" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Dmitriy Kanareykin</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-3165352306" data-role="relative-time" class="time-ago" title="Monday, February 20, 2017 8:53 AM">a year ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>If
 you look deeper into lock free algorithms you'll find that none but the
 simplest data structures can be implemented with just atomic 
loads/stores (which still cause cache contention). CAS and FAA are 
atomic operations (and therefore yes, in some sense, locking), but the 
algorithm built on top of them is not.<br>The definition of lock-free is
 simply that the system is guaranteed to progress if at least one thread
 (any thread) is allowed to progress. My queue offers this guarantee on 
the fast path.</p><p>If you benchmark an SRW lock based queue, I think you'll find it slower past a handful of concurrent threads.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1gckhgy"></li></ul></li><li class="realtime" data-role="realtime-notification:3165352306"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li><li class="post" id="post-2635787751"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_EsG3GvGgSC/" data-action="profile" data-username="disqus_EsG3GvGgSC" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="205314822" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_EsG3GvGgSC/" data-action="profile" data-username="disqus_EsG3GvGgSC" target="_blank" rel="noopener noreferrer">Vincent</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2581027216" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Jake Zhang</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2635787751" data-role="relative-time" class="time-ago" title="Thursday, April 21, 2016 2:17 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Can
 you please point me to the linux kernel spsc queue you referred above 
and can you quote some examples of robust spsc lock-free queues.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17la2uf"></li></ul></li><li class="realtime" data-role="realtime-notification:2635787751"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-2449330343"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar"><div class="user"><img src="a_data/noavatar92_002.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Jacob</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449330343" data-role="relative-time" class="time-ago" title="Saturday, January 9, 2016 10:15 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I had a quick look at the code...... I gave up very quickly.... <br>You can delete my comment after reading together with your blog entry and code on git.<br>This code is a humongous piece of spaghetti.. how exactly do you  attach the words "commercial strength" to it, huh?!?</p><p>Also, after about a minute I noticed you 'CanAlloc'. So that's not exactly lock-free is it?<br>Do you really believe anybody _serious_, in any company, would use anything like that? you must be joking.<br>I
 happen to have quite a bit of lock-free experience and let me tell you 
something - lock free things are typically very small in terms of lines 
of code and everything else. Not many abstraction levels to be easy to 
follow. Heavy C accent, no C++11, so it's easy to see how does it 
translate to asm.<br>Also, nobody needs a queue that allocates memory 
left and right. No malloc is not lock free (unless you provide your own 
lock free allocator and that's gonna be size limited....) so what have 
you gained there? People use either circular buffers or go intrusive 
(entries contain 'T* next'). Sync and wait are left out of the picture 
as in my world you typically spin rather than sleep. Lock free things, 
in general, are never full fledged whatever. They always give up on many
 things to achieve the one thing they need with ultimate speed, so don't
 try to go this way.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/14i9ndz"></li></ul></li><li class="realtime" data-role="realtime-notification:2449330343"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2449520906"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449330343" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Jacob</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449520906" data-role="relative-time" class="time-ago" title="Sunday, January 10, 2016 1:30 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I
 believe my exact words were "industrial strength", due to the features 
supported, combined with its speed. Yes, the code is messy and complex, 
mainly due to the quantity of optional features. Does that mean it's 
wrong? Worthless? Of course not. (Ironically, you managed to miss most 
of the actual flaws of the queue, which are already fairly well outlined
 in the documentation.)</p><p>It may not be what you're looking for, 
which is fine. You don't have to use it if you don't like it, or don't 
need any of its features. Go right ahead and write your own small 
highly-specialized lock-free data structure for each situation as it 
turns up. Don't forget to write the unit tests, scheduling-simulation 
tests, and ideally comparative benchmarks too. But not everyone has the 
luxury to spend that much time on a one-off data structure. That's why 
general-purpose, "kitchen sink" queues like mine and Boost's, and 
Intel's entire TBB library exist -- they allow the programmer to focus 
on their actual application at a higher level of abstraction. In fact, 
that's why most libraries exist.</p><p>If you'd spent less time scoffing
 at the code and more reading the documentation, you'd realize that 
external memory allocation (malloc) can only occur if the programmer 
chooses to use the version of the API that allows dynamic growth of the 
queue. This is a feature provided for convenience that, as it turns out,
 many people do actually use. Ditto for the (optional) exception safety 
and blocking version of the queue (both added solely due to public 
demand). It's completely lock-free if you need it to be, and still 
lock-free in the common case otherwise.</p><p>P.S. You come across as arrogant and a little bitter. You might want to work on that.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-2" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">2</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/14idqfe"></li></ul></li><li class="realtime" data-role="realtime-notification:2449520906"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2449769260"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar"><div class="user"><img src="a_data/noavatar92_002.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Jacob</span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449520906" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449769260" data-role="relative-time" class="time-ago" title="Sunday, January 10, 2016 7:45 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Sorry for the arrogance. The bitterness comes with the Guinness;)<br>I'm not looking for something. I write all the somethings I need.<br>Once
 in so often, I have a quick look at what people publish, just for the 
sake of it. And so, obviously, I did not go over all your code, and not 
all over the doc.<br>When you write small things, the testing is obviously smaller as well.<br>TBB's
 queue is horrible, just like yours. Boost's spsc_queue is good. Lokk at
 the simplicity - push and pop are just a few lines of code!<br>Actually
 I've written a similar queue (also based on ring buffer, push/pop may 
fail on lack of space) but I have several versions for sp/mp-sc/mc. 
Their mpmc queue is bad. Like I said, memory management is a separate 
topic and has to be left out of such containers.<br>All these guys don't go for ultimate performance but for fun and academic interests.<br>The
 guys who really push it are the HFT guys and they care less for the 
object model and unused features. We care only for the lowest latency in
 our very specific use case:)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/14ij224"></li></ul></li><li class="realtime" data-role="realtime-notification:2449769260"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2545923759"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/peterdelevoryas/" data-action="profile" data-username="peterdelevoryas" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="198789523" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/peterdelevoryas/" data-action="profile" data-username="peterdelevoryas" target="_blank" rel="noopener noreferrer">Peter Delevoryas</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449769260" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Jacob</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2545923759" data-role="relative-time" class="time-ago" title="Tuesday, March 1, 2016 2:00 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I
 just thought I would point out that Boost's spsc_queue is simpler than 
MoodyCamel's because it is a spsc queue, and incapable of supporting 
mpmc. Also, a mpmc queue's solution does not require that the algorithm 
is simple. If you believe that the simplest solution is always best, 
then I suppose you would also refute Judy Arrays on principle.</p><p>I 
realize there isn't any reason for me to reply to your comment, as it is
 2 months old and you are clearly a troll/etc, but I can't help myself.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/163rzcf"></li></ul></li><li class="realtime" data-role="realtime-notification:2545923759"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li><li class="post" id="post-2449776956"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar"><div class="user"><img src="a_data/noavatar92_002.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Jacob</span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449769260" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Jacob</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449776956" data-role="relative-time" class="time-ago" title="Sunday, January 10, 2016 7:53 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>One tiny thing I can share with you, just because you made such an effort:<br>You can write the simplest lockfree stack where any thread can push or pop, but (real life here ---&gt;)<br>1. give up on popping a single entry, coz in real life you have a single reader, you can pop them all in one go.<br>2. be intrusive. your users manage the entries.<br>After you've done that, I'm sure you can convert that to a queue.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/14ij7zw"></li></ul></li><li class="realtime" data-role="realtime-notification:2449776956"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2647830557"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/zenohate/" data-action="profile" data-username="zenohate" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="160928010" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/zenohate/" data-action="profile" data-username="zenohate" target="_blank" rel="noopener noreferrer">絶望の運び手/Zenohate</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2449776956" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Jacob</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647830557" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 2:49 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I
 have to disagree about 1 at least. You sometimes and on very serious 
kind of application have to use multiple readers to have proper 
optimization. At least I do. Also I use this mpmc queue, mainly because I
 hate the boost one for slowing down quickly with lots of threads. 
Imagine running it under 2000 threads in cuda cores ! Just impossible.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17sg74t"></li></ul></li><li class="realtime" data-role="realtime-notification:2647830557"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2647895797"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647830557" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> 絶望の運び手/Zenohate</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647895797" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 3:26 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Wait, does this mean you use my queue with over a thousand threads? It was not designed for that at all :-)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17shlh1"></li></ul></li><li class="realtime" data-role="realtime-notification:2647895797"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2647920368"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/zenohate/" data-action="profile" data-username="zenohate" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="160928010" src="a_data/avatar92_007.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/zenohate/" data-action="profile" data-username="zenohate" target="_blank" rel="noopener noreferrer">絶望の運び手/Zenohate</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647895797" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647920368" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 3:40 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It's
 the most gracious solution I find so far. The other MP-MC are too slow.
 Btw they are just about 32 Producers, and well a lot of consumers</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17si4fk"></li></ul></li><li class="realtime" data-role="realtime-notification:2647920368"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2647923212"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647920368" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> 絶望の運び手/Zenohate</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647923212" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 3:42 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Alright, cool. 32 is within the realm of normalcy.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17si6mk"></li></ul></li><li class="realtime" data-role="realtime-notification:2647923212"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2647936872"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/ludoviclagouardette/" data-action="profile" data-username="ludoviclagouardette" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172119150" src="a_data/avatar92_005.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/ludoviclagouardette/" data-action="profile" data-username="ludoviclagouardette" target="_blank" rel="noopener noreferrer">Ludovic Lagouardette</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647923212" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647936872" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 3:49 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Event based GPU computing at is finest. Almost all threads are CPU with a few exceptions.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17sih60"></li></ul></li><li class="realtime" data-role="realtime-notification:2647936872"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2647938436"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/ludoviclagouardette/" data-action="profile" data-username="ludoviclagouardette" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="172119150" src="a_data/avatar92_005.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/ludoviclagouardette/" data-action="profile" data-username="ludoviclagouardette" target="_blank" rel="noopener noreferrer">Ludovic Lagouardette</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647936872" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Ludovic Lagouardette</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2647938436" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 3:50 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Sorry for the confusion, other disqus account</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/17siidg"></li></ul></li><li class="realtime" data-role="realtime-notification:2647938436"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li class="post" id="post-2425490244"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/stevetaw/" data-action="profile" data-username="stevetaw" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="189235977" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/stevetaw/" data-action="profile" data-username="stevetaw" target="_blank" rel="noopener noreferrer">SteveTAW</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2425490244" data-role="relative-time" class="time-ago" title="Friday, December 25, 2015 4:03 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>There were build errors in VS2015 (using V2012 sln). Possible to look into that?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1442o90"></li></ul></li><li class="realtime" data-role="realtime-notification:2425490244"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2425654460"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2425490244" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> SteveTAW</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2425654460" data-role="relative-time" class="time-ago" title="Friday, December 25, 2015 9:35 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Of course. What were the build errors? Can you open an issue on <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fcameron314%2Fconcurrentqueue%3A-J1PWGHnIP0YS1HcTFpz2ZOQySg&amp;cuid=1124748" rel="nofollow noopener" title="https://github.com/cameron314/concurrentqueue">GitHub</a>?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/14466yk"></li></ul></li><li class="realtime" data-role="realtime-notification:2425654460"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2426198904"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/stevetaw/" data-action="profile" data-username="stevetaw" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="189235977" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/stevetaw/" data-action="profile" data-username="stevetaw" target="_blank" rel="noopener noreferrer">SteveTAW</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2425654460" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2426198904" data-role="relative-time" class="time-ago" title="Friday, December 25, 2015 9:54 PM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks. Submitted. Wish you a Merry Christmas and happy New Year 2016!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/144hv20"></li></ul></li><li class="realtime" data-role="realtime-notification:2426198904"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2426277931"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2426198904" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> SteveTAW</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2426277931" data-role="relative-time" class="time-ago" title="Saturday, December 26, 2015 12:12 AM">2 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks, you too :-) I'll look into it as soon as I can.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/144jk17"></li></ul></li><li class="realtime" data-role="realtime-notification:2426277931"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li></ul></li><li class="post" id="post-2161026111"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/virgoptrex/" data-action="profile" data-username="virgoptrex" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="36730387" src="a_data/avatar92.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/virgoptrex/" data-action="profile" data-username="virgoptrex" target="_blank" rel="noopener noreferrer">virgoptrex</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2161026111" data-role="relative-time" class="time-ago" title="Tuesday, July 28, 2015 7:54 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p><a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fcameron314%2Fconcurrentqueue%2Fblob%2Fmaster%2FLICENSE.md%3A1TwV475w-VJJ5AqZgIYO6862bbU&amp;cuid=1124748" rel="nofollow noopener" title="https://github.com/cameron314/concurrentqueue/blob/master/LICENSE.md">https://github.com/cameron3...</a></p><p>I
 am not clear if this is a commercial or personal license due to this 
line? This is a two clause BSD license if I am not mistaken.</p><p> 
"Boost queue (included in the benchmarks for comparison), Intel's TBB 
library (ditto), the CDSChecker tool (used for verification), the Relacy
 model checker (ditto), and Jeff Preshing's semaphore implementation 
(used in the blocking queue) which has a zlib license (embedded in 
blockingconcurrentqueue.h)?</p><p>This URL is interesting.<br><a href="http://disq.us/url?url=http%3A%2F%2Fchoosealicense.com%2Flicenses%2Fbsd-2-clause%2F%3Agis2fbJdF2WiUe3XxY9dmxVfrLk&amp;cuid=1124748" rel="nofollow noopener" title="http://choosealicense.com/licenses/bsd-2-clause/">http://choosealicense.com/l...</a>  (permits commercial use)<br>with parent URL.<br><a href="http://disq.us/url?url=http%3A%2F%2Fchoosealicense.com%2Flicenses%2F%3AmXopB2jBYBlTmReLG7CDPerLruk&amp;cuid=1124748" rel="nofollow noopener" title="http://choosealicense.com/licenses/">http://choosealicense.com/l...</a></p><p>Usually BSD license allows for commercial use. Can you clarify?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/zqmaf3"></li></ul></li><li class="realtime" data-role="realtime-notification:2161026111"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2161120557"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2161026111" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> virgoptrex</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2161120557" data-role="relative-time" class="time-ago" title="Tuesday, July 28, 2015 9:07 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I've
 licensed my own code under simplified BSD (2-clause), which indeed 
allows commercial use. The core queue itself (concurrentqueue.h) has no 
other dependencies, and so is solely licensed under BSD and can be used 
commercially.</p><p>The blocking version of the queue uses semaphore 
code adapted from what Jeff Preshing published under the zlib license, 
which also allows commercial use.</p><p>However, there's other code in 
the repository than just my own and Jeff's; the other queues I use for 
benchmarking against, for example, were not written by me, and have 
their own separate licenses as you've seen. The same goes for the 
testing tools. If you don't intend to use the parts of the test or 
benchmarking code that I haven't written commercially (and I don't see 
any reason why you would want to), then you're fine.</p><p>I hope this clears things up?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/zqobal"></li></ul></li><li class="realtime" data-role="realtime-notification:2161120557"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2162412209"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/virgoptrex/" data-action="profile" data-username="virgoptrex" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="36730387" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/virgoptrex/" data-action="profile" data-username="virgoptrex" target="_blank" rel="noopener noreferrer">virgoptrex</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2161120557" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2162412209" data-role="relative-time" class="time-ago" title="Tuesday, July 28, 2015 9:42 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks
 for the clarification. I don't intend to use bench marking. So 
basically if I drop those two header files (by you and Jeff) in my code 
along with your respective license files and delete all other folders to
 be on safe side then I should be good. That is my understanding. 
Correct?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/zrfzxt"></li></ul></li><li class="realtime" data-role="realtime-notification:2162412209"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2162498428"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2162412209" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> virgoptrex</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2162498428" data-role="relative-time" class="time-ago" title="Tuesday, July 28, 2015 10:37 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Yep!</p><p>In
 fact, you don't have to go that far -- everything except 
tests/CDSChecker/model-checker, tests/relacy/relacy, benchmarks/boost, 
and benchmarks/tbb was written by me (with the exception of Jeff's 
semaphore code) and is under the BSD license. I think perhaps that's the
 clearest way of stating things (I should probably update the readme!).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/zrhugs"></li></ul></li><li class="realtime" data-role="realtime-notification:2162498428"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2166467197"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/virgoptrex/" data-action="profile" data-username="virgoptrex" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="36730387" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/virgoptrex/" data-action="profile" data-username="virgoptrex" target="_blank" rel="noopener noreferrer">virgoptrex</a></span> </span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2162498428" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2166467197" data-role="relative-time" class="time-ago" title="Thursday, July 30, 2015 10:51 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Cool! Awesome! Thanks for being crystal clear.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/ztuwsd"></li></ul></li><li class="realtime" data-role="realtime-notification:2166467197"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li></ul></li></ul></li><li class="post" id="post-2056792887"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/antoniocarlosnazarjnior/" data-action="profile" data-username="antoniocarlosnazarjnior" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="159974045" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/antoniocarlosnazarjnior/" data-action="profile" data-username="antoniocarlosnazarjnior" target="_blank" rel="noopener noreferrer">Antonio Carlos Nazaré Júnior</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2056792887" data-role="relative-time" class="time-ago" title="Monday, June 1, 2015 3:50 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Cameron,</p><p>Firstly congratulations for your implementation, it is very useful. <br>I have a question: There is a clear (reset) function?</p><p>Thanks in advance</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/y0k7jr"></li></ul></li><li class="realtime" data-role="realtime-notification:2056792887"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2056856778"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2056792887" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Antonio Carlos Nazaré Júnior</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2056856778" data-role="relative-time" class="time-ago" title="Monday, June 1, 2015 4:22 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>There is not, currently. You'll have to manually pump the queue until it's empty, for now.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/y0lkui"></li></ul></li><li class="realtime" data-role="realtime-notification:2056856778"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-2052868480"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_j3TN0f4CuC/" data-action="profile" data-username="disqus_j3TN0f4CuC" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="159661622" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_j3TN0f4CuC/" data-action="profile" data-username="disqus_j3TN0f4CuC" target="_blank" rel="noopener noreferrer">Mohsen</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2052868480" data-role="relative-time" class="time-ago" title="Saturday, May 30, 2015 3:00 AM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>can i use it without c++11 and is your lib support arm processors?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/xy83gg"></li></ul></li><li class="realtime" data-role="realtime-notification:2052868480"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2053475787"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2052868480" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Mohsen</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2053475787" data-role="relative-time" class="time-ago" title="Saturday, May 30, 2015 1:24 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I'm afraid it absolutely requires a C++11 compiler.<br>I have not tested it on ARM, but it should work correctly -- the algorithms and implementation are processor-agnostic.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/xyl423"></li></ul></li><li class="realtime" data-role="realtime-notification:2053475787"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-2036510443"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar"><div class="user"><img src="a_data/noavatar92_002.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Johannes</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2036510443" data-role="relative-time" class="time-ago" title="Wednesday, May 20, 2015 6:03 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I
 stumbled over your great implementation for a MPMC data structure and 
played around a little with it. It seems really well done and with a lot
 of precious details in code. I was wondering if this implementation 
could be easily changed from a queue (FIFO) to a stack (LIFO)?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/xohhij"></li></ul></li><li class="realtime" data-role="realtime-notification:2036510443"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2036516931"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2036510443" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Johannes</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2036516931" data-role="relative-time" class="time-ago" title="Wednesday, May 20, 2015 6:07 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks
 :-) Unfortunately, the short answer is no. The code is extremely 
complex, and very much tied to the specifics of the queue FIFO 
semantics.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/xohmir"></li></ul></li><li class="realtime" data-role="realtime-notification:2036516931"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2036539440"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar"><div class="user"><img src="a_data/noavatar92_002.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Johannes</span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2036516931" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cameron</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2036539440" data-role="relative-time" class="time-ago" title="Wednesday, May 20, 2015 6:24 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Too
 bad, I was happy that I have found such a great implementation - just 
the order of elements is the other way round... Anyways, thanks again 
for your great work!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/xoi3w0"></li></ul></li><li class="realtime" data-role="realtime-notification:2036539440"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul></li><li class="post" id="post-2016049516"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/ThoraxImpailor/" data-action="profile" data-username="ThoraxImpailor" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="8305310" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/ThoraxImpailor/" data-action="profile" data-username="ThoraxImpailor" target="_blank" rel="noopener noreferrer">ThoraxImpailor</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2016049516" data-role="relative-time" class="time-ago" title="Saturday, May 9, 2015 7:43 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hey
 Cameron, I'm curious - have you attempted to benchmark your concurrent 
queue against facebook's Folly MPMCQueue? I would be very tempted to see
 how they perform against one another, especially given how lightweight 
your implementation is compared to that of Folly.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/xcaxrg"></li></ul></li><li class="realtime" data-role="realtime-notification:2016049516"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-2016921677"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2016049516" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> ThoraxImpailor</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-2016921677" data-role="relative-time" class="time-ago" title="Sunday, May 10, 2015 12:35 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>No,
 I have not -- I didn't know it existed! I'll open an issue on GitHub to
 add it to the benchmark code. Not sure I would call my implementation 
"light" though ;-)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/xctmq5"></li></ul></li><li class="realtime" data-role="realtime-notification:2016921677"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-1999569571"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/Ranshalit/" data-action="profile" data-username="Ranshalit" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="125214668" src="a_data/noavatar92_002.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/Ranshalit/" data-action="profile" data-username="Ranshalit" target="_blank" rel="noopener noreferrer">ran</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-1999569571" data-role="relative-time" class="time-ago" title="Saturday, May 2, 2015 12:38 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Cameron,</p><p>The lock-free means that there is no blocking when queue is empty ?<br>Is there also a feature which makes the Queue get blocked when empty ?</p><p>Thanks,<br>Ran</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/x2hpr7"></li></ul></li><li class="realtime" data-role="realtime-notification:1999569571"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-1999869820"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-1999569571" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> ran</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-1999869820" data-role="relative-time" class="time-ago" title="Saturday, May 2, 2015 4:13 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Lock-free simply means there are no locks involved in the common operations, and is independent of blocking/non-blocking.</p><p>I
 did in fact recently add a blocking version of the queue (in the 
'blockingconcurrentqueue.h' header file) that provides `wait_dequeue` 
methods that block while the queue is empty.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/x2o5fg"></li></ul></li><li class="realtime" data-role="realtime-notification:1999869820"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li><li class="post" id="post-1949604766"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar"><div class="user"><img src="a_data/noavatar92_002.png" class="user" alt="Avatar"></div></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span class="author">Bill T.</span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-1949604766" data-role="relative-time" class="time-ago" title="Monday, April 6, 2015 4:19 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>So
 I'm trying to use your queue as a replacement for a 
tbb::concurrent_bounded_queue by putting a semaphore wait in front of 
every try_dequeue and a semaphore post after every successful 
try_enqueue. Sadly, when I do this, the program hangs. I don't 
understand what could be going wrong here -- the semaphore's just 
counting the number of elements in the queue, fer cryin' out loud. Has 
anyone else tried this and gotten it to work?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/w8qsny"></li></ul></li><li class="realtime" data-role="realtime-notification:1949604766"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"><li class="post" id="post-1949623892"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu"><li class="collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class="" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="18992720" src="a_data/avatar92_006.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cameron314/" data-action="profile" data-username="cameron314" target="_blank" rel="noopener noreferrer">Cameron</a></span> <span class="badge moderator">Mod</span></span><span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-1949604766" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Bill T.</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true">•</span> <a href="http://moodycamel.com/blog/2014/a-fast-general-purpose-lock-free-queue-for-c++#comment-1949623892" data-role="relative-time" class="time-ago" title="Monday, April 6, 2015 4:30 PM">3 years ago</a></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I'm
 presently working on a blocking version (using a semaphore), which 
should be ready soonish. In the meantime, I suggest opening an issue on 
GitHub with some sample code. I'll take a look at it.</p><p>The hang is 
likely due to a misuse of try_enqueue, which has happened several times 
lately. It's my fault for not properly documenting it (that's on my 
near-term TODO list too). It's entirely possible that try_enqueue never 
returns success (since the queue is empty by default and thus no 
attempts to try_enqueue ever succeed), in which case all blocking 
attempts to dequeue will wait forever. Does it do anything if you remove
 the semaphore part?</p><p>Apart from that, there's no guarantee that 
try_dequeue will always succeed even if the semaphore wait was 
successful -- the queue is only eventually consistent, so a correct 
blocking implementation must call try_dequeue in a loop until a value is
 found after acquiring the semaphore. This will make a difference under 
contention (your semaphore could become out of sync with the actual 
number of elements in the queue otherwise, again leading to a potential 
hang).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a> <a href="#" role="button" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span></a></div></li><li class="bullet" aria-hidden="true">•</li><li class="reply" data-role="reply-link"><a href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><li class="twitter"><button class="share__button" data-action="share:twitter">Twitter</button></li><li class="facebook"><button class="share__button" data-action="share:facebook">Facebook</button></li><li class="link"><input class="share__button" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/w8r7f8"></li></ul></li><li class="realtime" data-role="realtime-notification:1949623892"><span style="display: none;" class="realtime-replies"></span><a style="display: none;" href="#" class="realtime-button"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><ul data-role="children" class="children"></ul></li></ul></li></ul><div class="load-more" data-role="more" style=""><a href="#" data-action="more-posts" class="btn load-more__button">Load more comments</a></div></div></section><div id="placement-bottom" data-tracking-area="discovery-south"></div><div id="footer" data-tracking-area="footer" class="disqus-footer__wrapper"><ul class="disqus-footer"><li class="disqus-footer__logo"><a href="https://disqus.com/" rel="nofollow" title="Powered by Disqus" class="disqus-footer__link">Powered by Disqus</a></li><li id="thread-subscribe-button" class="email disqus-footer__item"><div class="default"><a href="#" rel="nofollow" data-action="subscribe" title="Subscribe and get email updates from this discussion" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-mail"></i><span class="clip">Subscribe</span><i aria-hidden="true" class="icon icon-checkmark"></i></a></div></li><li class="install disqus-footer__item"><a href="https://publishers.disqus.com/engage?utm_source=moodycamel&amp;utm_medium=Disqus-Footer" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-disqus"></i><span class="clip hidden-md">Add Disqus to your site</span><span class="clip visible-md hidden-xs">Add Disqus</span><span class="clip visible-xs">Add</span></a></li><li class="privacy disqus-footer__item"><a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-lock"></i><span class="clip hidden-sm">Disqus' Privacy Policy</span><span class="clip visible-sm hidden-xs">Privacy Policy</span><span class="clip visible-xs">Privacy</span></a></li></ul></div></div><iframe style="position: absolute; width: 1px; height: 1px; left: -9999px; display: none;" aria-hidden="true" id="ssIFrame_google" sandbox="allow-scripts allow-same-origin" src="a_data/iframe.html"></iframe><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="a_data/oVjM2wVZ10b.html" frameborder="0"></iframe></div></div></div><img style="display: none !important;" src="a_data/a.gif" hidden=""><iframe style="display: none !important;" src="//live.rezync.com/pixel.html?c=4656c20ee35215f78e9273796625d90b&amp;cid=c3jb96en3bjktm3" hidden=""></iframe><iframe style="display: none !important;" src="//pippio.com/api/sync?pid=1391&amp;ref=http%3A%2F%2Fmoodycamel.com%2Fblog%2F2014%2Fa-fast-general-purpose-lock-free-queue-for-c%2B%2B&amp;it=1&amp;iv=c3jb96en3bjktm3" hidden=""></iframe></body></html>